/**
 * hm-8nb-spring-fashion
 * 2017-03-27, 16:28
 */

;(function () {
    'use strict';

    /**
     * @preserve FastClick: polyfill to remove click delays on browsers with touch UIs.
     *
     * @codingstandard ftlabs-jsv2
     * @copyright The Financial Times Limited [All Rights Reserved]
     * @license MIT License (see LICENSE.txt)
     */

    /*jslint browser:true, node:true*/
    /*global define, Event, Node*/


    /**
     * Instantiate fast-clicking listeners on the specified layer.
     *
     * @constructor
     * @param {Element} layer The layer to listen on
     * @param {Object} [options={}] The options to override the defaults
     */
    function FastClick(layer, options) {
        var oldOnClick;

        options = options || {};

        /**
         * Whether a click is currently being tracked.
         *
         * @type boolean
         */
        this.trackingClick = false;


        /**
         * Timestamp for when click tracking started.
         *
         * @type number
         */
        this.trackingClickStart = 0;


        /**
         * The element being tracked for a click.
         *
         * @type EventTarget
         */
        this.targetElement = null;


        /**
         * X-coordinate of touch start event.
         *
         * @type number
         */
        this.touchStartX = 0;


        /**
         * Y-coordinate of touch start event.
         *
         * @type number
         */
        this.touchStartY = 0;


        /**
         * ID of the last touch, retrieved from Touch.identifier.
         *
         * @type number
         */
        this.lastTouchIdentifier = 0;


        /**
         * Touchmove boundary, beyond which a click will be cancelled.
         *
         * @type number
         */
        this.touchBoundary = options.touchBoundary || 10;


        /**
         * The FastClick layer.
         *
         * @type Element
         */
        this.layer = layer;

        /**
         * The minimum time between tap(touchstart and touchend) events
         *
         * @type number
         */
        this.tapDelay = options.tapDelay || 200;

        /**
         * The maximum time for a tap
         *
         * @type number
         */
        this.tapTimeout = options.tapTimeout || 700;

        if (FastClick.notNeeded(layer)) {
            return;
        }

        // Some old versions of Android don't have Function.prototype.bind
        function bind(method, context) {
            return function() { return method.apply(context, arguments); };
        }


        var methods = ['onMouse', 'onClick', 'onTouchStart', 'onTouchMove', 'onTouchEnd', 'onTouchCancel'];
        var context = this;
        for (var i = 0, l = methods.length; i < l; i++) {
            context[methods[i]] = bind(context[methods[i]], context);
        }

        // Set up event handlers as required
        if (deviceIsAndroid) {
            layer.addEventListener('mouseover', this.onMouse, true);
            layer.addEventListener('mousedown', this.onMouse, true);
            layer.addEventListener('mouseup', this.onMouse, true);
        }

        layer.addEventListener('click', this.onClick, true);
        layer.addEventListener('touchstart', this.onTouchStart, false);
        layer.addEventListener('touchmove', this.onTouchMove, false);
        layer.addEventListener('touchend', this.onTouchEnd, false);
        layer.addEventListener('touchcancel', this.onTouchCancel, false);

        // Hack is required for browsers that don't support Event#stopImmediatePropagation (e.g. Android 2)
        // which is how FastClick normally stops click events bubbling to callbacks registered on the FastClick
        // layer when they are cancelled.
        if (!Event.prototype.stopImmediatePropagation) {
            layer.removeEventListener = function(type, callback, capture) {
                var rmv = Node.prototype.removeEventListener;
                if (type === 'click') {
                    rmv.call(layer, type, callback.hijacked || callback, capture);
                } else {
                    rmv.call(layer, type, callback, capture);
                }
            };

            layer.addEventListener = function(type, callback, capture) {
                var adv = Node.prototype.addEventListener;
                if (type === 'click') {
                    adv.call(layer, type, callback.hijacked || (callback.hijacked = function(event) {
                        if (!event.propagationStopped) {
                            callback(event);
                        }
                    }), capture);
                } else {
                    adv.call(layer, type, callback, capture);
                }
            };
        }

        // If a handler is already declared in the element's onclick attribute, it will be fired before
        // FastClick's onClick handler. Fix this by pulling out the user-defined handler function and
        // adding it as listener.
        if (typeof layer.onclick === 'function') {

            // Android browser on at least 3.2 requires a new reference to the function in layer.onclick
            // - the old one won't work if passed to addEventListener directly.
            oldOnClick = layer.onclick;
            layer.addEventListener('click', function(event) {
                oldOnClick(event);
            }, false);
            layer.onclick = null;
        }
    }

    /**
    * Windows Phone 8.1 fakes user agent string to look like Android and iPhone.
    *
    * @type boolean
    */
    var deviceIsWindowsPhone = navigator.userAgent.indexOf("Windows Phone") >= 0;

    /**
     * Android requires exceptions.
     *
     * @type boolean
     */
    var deviceIsAndroid = navigator.userAgent.indexOf('Android') > 0 && !deviceIsWindowsPhone;


    /**
     * iOS requires exceptions.
     *
     * @type boolean
     */
    var deviceIsIOS = /iP(ad|hone|od)/.test(navigator.userAgent) && !deviceIsWindowsPhone;


    /**
     * iOS 4 requires an exception for select elements.
     *
     * @type boolean
     */
    var deviceIsIOS4 = deviceIsIOS && (/OS 4_\d(_\d)?/).test(navigator.userAgent);


    /**
     * iOS 6.0-7.* requires the target element to be manually derived
     *
     * @type boolean
     */
    var deviceIsIOSWithBadTarget = deviceIsIOS && (/OS [6-7]_\d/).test(navigator.userAgent);

    /**
     * BlackBerry requires exceptions.
     *
     * @type boolean
     */
    var deviceIsBlackBerry10 = navigator.userAgent.indexOf('BB10') > 0;

    /**
     * Determine whether a given element requires a native click.
     *
     * @param {EventTarget|Element} target Target DOM element
     * @returns {boolean} Returns true if the element needs a native click
     */
    FastClick.prototype.needsClick = function(target) {
        switch (target.nodeName.toLowerCase()) {

        // Don't send a synthetic click to disabled inputs (issue #62)
        case 'button':
        case 'select':
        case 'textarea':
            if (target.disabled) {
                return true;
            }

            break;
        case 'input':

            // File inputs need real clicks on iOS 6 due to a browser bug (issue #68)
            if ((deviceIsIOS && target.type === 'file') || target.disabled) {
                return true;
            }

            break;
        case 'label':
        case 'iframe': // iOS8 homescreen apps can prevent events bubbling into frames
        case 'video':
            return true;
        }

        return (/\bneedsclick\b/).test(target.className);
    };


    /**
     * Determine whether a given element requires a call to focus to simulate click into element.
     *
     * @param {EventTarget|Element} target Target DOM element
     * @returns {boolean} Returns true if the element requires a call to focus to simulate native click.
     */
    FastClick.prototype.needsFocus = function(target) {
        switch (target.nodeName.toLowerCase()) {
        case 'textarea':
            return true;
        case 'select':
            return !deviceIsAndroid;
        case 'input':
            switch (target.type) {
            case 'button':
            case 'checkbox':
            case 'file':
            case 'image':
            case 'radio':
            case 'submit':
                return false;
            }

            // No point in attempting to focus disabled inputs
            return !target.disabled && !target.readOnly;
        default:
            return (/\bneedsfocus\b/).test(target.className);
        }
    };


    /**
     * Send a click event to the specified element.
     *
     * @param {EventTarget|Element} targetElement
     * @param {Event} event
     */
    FastClick.prototype.sendClick = function(targetElement, event) {
        var clickEvent, touch;

        // On some Android devices activeElement needs to be blurred otherwise the synthetic click will have no effect (#24)
        if (document.activeElement && document.activeElement !== targetElement) {
            document.activeElement.blur();
        }

        touch = event.changedTouches[0];

        // Synthesise a click event, with an extra attribute so it can be tracked
        clickEvent = document.createEvent('MouseEvents');
        clickEvent.initMouseEvent(this.determineEventType(targetElement), true, true, window, 1, touch.screenX, touch.screenY, touch.clientX, touch.clientY, false, false, false, false, 0, null);
        clickEvent.forwardedTouchEvent = true;
        targetElement.dispatchEvent(clickEvent);
    };

    FastClick.prototype.determineEventType = function(targetElement) {

        //Issue #159: Android Chrome Select Box does not open with a synthetic click event
        if (deviceIsAndroid && targetElement.tagName.toLowerCase() === 'select') {
            return 'mousedown';
        }

        return 'click';
    };


    /**
     * @param {EventTarget|Element} targetElement
     */
    FastClick.prototype.focus = function(targetElement) {
        var length;

        // Issue #160: on iOS 7, some input elements (e.g. date datetime month) throw a vague TypeError on setSelectionRange. These elements don't have an integer value for the selectionStart and selectionEnd properties, but unfortunately that can't be used for detection because accessing the properties also throws a TypeError. Just check the type instead. Filed as Apple bug #15122724.
        if (deviceIsIOS && targetElement.setSelectionRange && targetElement.type.indexOf('date') !== 0 && targetElement.type !== 'time' && targetElement.type !== 'month') {
            length = targetElement.value.length;
            targetElement.setSelectionRange(length, length);
        } else {
            targetElement.focus();
        }
    };


    /**
     * Check whether the given target element is a child of a scrollable layer and if so, set a flag on it.
     *
     * @param {EventTarget|Element} targetElement
     */
    FastClick.prototype.updateScrollParent = function(targetElement) {
        var scrollParent, parentElement;

        scrollParent = targetElement.fastClickScrollParent;

        // Attempt to discover whether the target element is contained within a scrollable layer. Re-check if the
        // target element was moved to another parent.
        if (!scrollParent || !scrollParent.contains(targetElement)) {
            parentElement = targetElement;
            do {
                if (parentElement.scrollHeight > parentElement.offsetHeight) {
                    scrollParent = parentElement;
                    targetElement.fastClickScrollParent = parentElement;
                    break;
                }

                parentElement = parentElement.parentElement;
            } while (parentElement);
        }

        // Always update the scroll top tracker if possible.
        if (scrollParent) {
            scrollParent.fastClickLastScrollTop = scrollParent.scrollTop;
        }
    };


    /**
     * @param {EventTarget} targetElement
     * @returns {Element|EventTarget}
     */
    FastClick.prototype.getTargetElementFromEventTarget = function(eventTarget) {

        // On some older browsers (notably Safari on iOS 4.1 - see issue #56) the event target may be a text node.
        if (eventTarget.nodeType === Node.TEXT_NODE) {
            return eventTarget.parentNode;
        }

        return eventTarget;
    };


    /**
     * On touch start, record the position and scroll offset.
     *
     * @param {Event} event
     * @returns {boolean}
     */
    FastClick.prototype.onTouchStart = function(event) {
        var targetElement, touch, selection;

        // Ignore multiple touches, otherwise pinch-to-zoom is prevented if both fingers are on the FastClick element (issue #111).
        if (event.targetTouches.length > 1) {
            return true;
        }

        targetElement = this.getTargetElementFromEventTarget(event.target);
        touch = event.targetTouches[0];

        if (deviceIsIOS) {

            // Only trusted events will deselect text on iOS (issue #49)
            selection = window.getSelection();
            if (selection.rangeCount && !selection.isCollapsed) {
                return true;
            }

            if (!deviceIsIOS4) {

                // Weird things happen on iOS when an alert or confirm dialog is opened from a click event callback (issue #23):
                // when the user next taps anywhere else on the page, new touchstart and touchend events are dispatched
                // with the same identifier as the touch event that previously triggered the click that triggered the alert.
                // Sadly, there is an issue on iOS 4 that causes some normal touch events to have the same identifier as an
                // immediately preceeding touch event (issue #52), so this fix is unavailable on that platform.
                // Issue 120: touch.identifier is 0 when Chrome dev tools 'Emulate touch events' is set with an iOS device UA string,
                // which causes all touch events to be ignored. As this block only applies to iOS, and iOS identifiers are always long,
                // random integers, it's safe to to continue if the identifier is 0 here.
                if (touch.identifier && touch.identifier === this.lastTouchIdentifier) {
                    event.preventDefault();
                    return false;
                }

                this.lastTouchIdentifier = touch.identifier;

                // If the target element is a child of a scrollable layer (using -webkit-overflow-scrolling: touch) and:
                // 1) the user does a fling scroll on the scrollable layer
                // 2) the user stops the fling scroll with another tap
                // then the event.target of the last 'touchend' event will be the element that was under the user's finger
                // when the fling scroll was started, causing FastClick to send a click event to that layer - unless a check
                // is made to ensure that a parent layer was not scrolled before sending a synthetic click (issue #42).
                this.updateScrollParent(targetElement);
            }
        }

        this.trackingClick = true;
        this.trackingClickStart = event.timeStamp;
        this.targetElement = targetElement;

        this.touchStartX = touch.pageX;
        this.touchStartY = touch.pageY;

        // Prevent phantom clicks on fast double-tap (issue #36)
        if ((event.timeStamp - this.lastClickTime) < this.tapDelay) {
            event.preventDefault();
        }

        return true;
    };


    /**
     * Based on a touchmove event object, check whether the touch has moved past a boundary since it started.
     *
     * @param {Event} event
     * @returns {boolean}
     */
    FastClick.prototype.touchHasMoved = function(event) {
        var touch = event.changedTouches[0], boundary = this.touchBoundary;

        if (Math.abs(touch.pageX - this.touchStartX) > boundary || Math.abs(touch.pageY - this.touchStartY) > boundary) {
            return true;
        }

        return false;
    };


    /**
     * Update the last position.
     *
     * @param {Event} event
     * @returns {boolean}
     */
    FastClick.prototype.onTouchMove = function(event) {
        if (!this.trackingClick) {
            return true;
        }

        // If the touch has moved, cancel the click tracking
        if (this.targetElement !== this.getTargetElementFromEventTarget(event.target) || this.touchHasMoved(event)) {
            this.trackingClick = false;
            this.targetElement = null;
        }

        return true;
    };


    /**
     * Attempt to find the labelled control for the given label element.
     *
     * @param {EventTarget|HTMLLabelElement} labelElement
     * @returns {Element|null}
     */
    FastClick.prototype.findControl = function(labelElement) {

        // Fast path for newer browsers supporting the HTML5 control attribute
        if (labelElement.control !== undefined) {
            return labelElement.control;
        }

        // All browsers under test that support touch events also support the HTML5 htmlFor attribute
        if (labelElement.htmlFor) {
            return document.getElementById(labelElement.htmlFor);
        }

        // If no for attribute exists, attempt to retrieve the first labellable descendant element
        // the list of which is defined here: http://www.w3.org/TR/html5/forms.html#category-label
        return labelElement.querySelector('button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea');
    };


    /**
     * On touch end, determine whether to send a click event at once.
     *
     * @param {Event} event
     * @returns {boolean}
     */
    FastClick.prototype.onTouchEnd = function(event) {
        var forElement, trackingClickStart, targetTagName, scrollParent, touch, targetElement = this.targetElement;

        if (!this.trackingClick) {
            return true;
        }

        // Prevent phantom clicks on fast double-tap (issue #36)
        if ((event.timeStamp - this.lastClickTime) < this.tapDelay) {
            this.cancelNextClick = true;
            return true;
        }

        if ((event.timeStamp - this.trackingClickStart) > this.tapTimeout) {
            return true;
        }

        // Reset to prevent wrong click cancel on input (issue #156).
        this.cancelNextClick = false;

        this.lastClickTime = event.timeStamp;

        trackingClickStart = this.trackingClickStart;
        this.trackingClick = false;
        this.trackingClickStart = 0;

        // On some iOS devices, the targetElement supplied with the event is invalid if the layer
        // is performing a transition or scroll, and has to be re-detected manually. Note that
        // for this to function correctly, it must be called *after* the event target is checked!
        // See issue #57; also filed as rdar://13048589 .
        if (deviceIsIOSWithBadTarget) {
            touch = event.changedTouches[0];

            // In certain cases arguments of elementFromPoint can be negative, so prevent setting targetElement to null
            targetElement = document.elementFromPoint(touch.pageX - window.pageXOffset, touch.pageY - window.pageYOffset) || targetElement;
            targetElement.fastClickScrollParent = this.targetElement.fastClickScrollParent;
        }

        targetTagName = targetElement.tagName.toLowerCase();
        if (targetTagName === 'label') {
            forElement = this.findControl(targetElement);
            if (forElement) {
                this.focus(targetElement);
                if (deviceIsAndroid) {
                    return false;
                }

                targetElement = forElement;
            }
        } else if (this.needsFocus(targetElement)) {

            // Case 1: If the touch started a while ago (best guess is 100ms based on tests for issue #36) then focus will be triggered anyway. Return early and unset the target element reference so that the subsequent click will be allowed through.
            // Case 2: Without this exception for input elements tapped when the document is contained in an iframe, then any inputted text won't be visible even though the value attribute is updated as the user types (issue #37).
            if ((event.timeStamp - trackingClickStart) > 100 || (deviceIsIOS && window.top !== window && targetTagName === 'input')) {
                this.targetElement = null;
                return false;
            }

            this.focus(targetElement);
            this.sendClick(targetElement, event);

            // Select elements need the event to go through on iOS 4, otherwise the selector menu won't open.
            // Also this breaks opening selects when VoiceOver is active on iOS6, iOS7 (and possibly others)
            if (!deviceIsIOS || targetTagName !== 'select') {
                this.targetElement = null;
                event.preventDefault();
            }

            return false;
        }

        if (deviceIsIOS && !deviceIsIOS4) {

            // Don't send a synthetic click event if the target element is contained within a parent layer that was scrolled
            // and this tap is being used to stop the scrolling (usually initiated by a fling - issue #42).
            scrollParent = targetElement.fastClickScrollParent;
            if (scrollParent && scrollParent.fastClickLastScrollTop !== scrollParent.scrollTop) {
                return true;
            }
        }

        // Prevent the actual click from going though - unless the target node is marked as requiring
        // real clicks or if it is in the whitelist in which case only non-programmatic clicks are permitted.
        if (!this.needsClick(targetElement)) {
            event.preventDefault();
            this.sendClick(targetElement, event);
        }

        return false;
    };


    /**
     * On touch cancel, stop tracking the click.
     *
     * @returns {void}
     */
    FastClick.prototype.onTouchCancel = function() {
        this.trackingClick = false;
        this.targetElement = null;
    };


    /**
     * Determine mouse events which should be permitted.
     *
     * @param {Event} event
     * @returns {boolean}
     */
    FastClick.prototype.onMouse = function(event) {

        // If a target element was never set (because a touch event was never fired) allow the event
        if (!this.targetElement) {
            return true;
        }

        if (event.forwardedTouchEvent) {
            return true;
        }

        // Programmatically generated events targeting a specific element should be permitted
        if (!event.cancelable) {
            return true;
        }

        // Derive and check the target element to see whether the mouse event needs to be permitted;
        // unless explicitly enabled, prevent non-touch click events from triggering actions,
        // to prevent ghost/doubleclicks.
        if (!this.needsClick(this.targetElement) || this.cancelNextClick) {

            // Prevent any user-added listeners declared on FastClick element from being fired.
            if (event.stopImmediatePropagation) {
                event.stopImmediatePropagation();
            } else {

                // Part of the hack for browsers that don't support Event#stopImmediatePropagation (e.g. Android 2)
                event.propagationStopped = true;
            }

            // Cancel the event
            event.stopPropagation();
            event.preventDefault();

            return false;
        }

        // If the mouse event is permitted, return true for the action to go through.
        return true;
    };


    /**
     * On actual clicks, determine whether this is a touch-generated click, a click action occurring
     * naturally after a delay after a touch (which needs to be cancelled to avoid duplication), or
     * an actual click which should be permitted.
     *
     * @param {Event} event
     * @returns {boolean}
     */
    FastClick.prototype.onClick = function(event) {
        var permitted;

        // It's possible for another FastClick-like library delivered with third-party code to fire a click event before FastClick does (issue #44). In that case, set the click-tracking flag back to false and return early. This will cause onTouchEnd to return early.
        if (this.trackingClick) {
            this.targetElement = null;
            this.trackingClick = false;
            return true;
        }

        // Very odd behaviour on iOS (issue #18): if a submit element is present inside a form and the user hits enter in the iOS simulator or clicks the Go button on the pop-up OS keyboard the a kind of 'fake' click event will be triggered with the submit-type input element as the target.
        if (event.target.type === 'submit' && event.detail === 0) {
            return true;
        }

        permitted = this.onMouse(event);

        // Only unset targetElement if the click is not permitted. This will ensure that the check for !targetElement in onMouse fails and the browser's click doesn't go through.
        if (!permitted) {
            this.targetElement = null;
        }

        // If clicks are permitted, return true for the action to go through.
        return permitted;
    };


    /**
     * Remove all FastClick's event listeners.
     *
     * @returns {void}
     */
    FastClick.prototype.destroy = function() {
        var layer = this.layer;

        if (deviceIsAndroid) {
            layer.removeEventListener('mouseover', this.onMouse, true);
            layer.removeEventListener('mousedown', this.onMouse, true);
            layer.removeEventListener('mouseup', this.onMouse, true);
        }

        layer.removeEventListener('click', this.onClick, true);
        layer.removeEventListener('touchstart', this.onTouchStart, false);
        layer.removeEventListener('touchmove', this.onTouchMove, false);
        layer.removeEventListener('touchend', this.onTouchEnd, false);
        layer.removeEventListener('touchcancel', this.onTouchCancel, false);
    };


    /**
     * Check whether FastClick is needed.
     *
     * @param {Element} layer The layer to listen on
     */
    FastClick.notNeeded = function(layer) {
        var metaViewport;
        var chromeVersion;
        var blackberryVersion;
        var firefoxVersion;

        // Devices that don't support touch don't need FastClick
        if (typeof window.ontouchstart === 'undefined') {
            return true;
        }

        // Chrome version - zero for other browsers
        chromeVersion = +(/Chrome\/([0-9]+)/.exec(navigator.userAgent) || [,0])[1];

        if (chromeVersion) {

            if (deviceIsAndroid) {
                metaViewport = document.querySelector('meta[name=viewport]');

                if (metaViewport) {
                    // Chrome on Android with user-scalable="no" doesn't need FastClick (issue #89)
                    if (metaViewport.content.indexOf('user-scalable=no') !== -1) {
                        return true;
                    }
                    // Chrome 32 and above with width=device-width or less don't need FastClick
                    if (chromeVersion > 31 && document.documentElement.scrollWidth <= window.outerWidth) {
                        return true;
                    }
                }

            // Chrome desktop doesn't need FastClick (issue #15)
            } else {
                return true;
            }
        }

        if (deviceIsBlackBerry10) {
            blackberryVersion = navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/);

            // BlackBerry 10.3+ does not require Fastclick library.
            // https://github.com/ftlabs/fastclick/issues/251
            if (blackberryVersion[1] >= 10 && blackberryVersion[2] >= 3) {
                metaViewport = document.querySelector('meta[name=viewport]');

                if (metaViewport) {
                    // user-scalable=no eliminates click delay.
                    if (metaViewport.content.indexOf('user-scalable=no') !== -1) {
                        return true;
                    }
                    // width=device-width (or less than device-width) eliminates click delay.
                    if (document.documentElement.scrollWidth <= window.outerWidth) {
                        return true;
                    }
                }
            }
        }

        // IE10 with -ms-touch-action: none or manipulation, which disables double-tap-to-zoom (issue #97)
        if (layer.style.msTouchAction === 'none' || layer.style.touchAction === 'manipulation') {
            return true;
        }

        // Firefox version - zero for other browsers
        firefoxVersion = +(/Firefox\/([0-9]+)/.exec(navigator.userAgent) || [,0])[1];

        if (firefoxVersion >= 27) {
            // Firefox 27+ does not have tap delay if the content is not zoomable - https://bugzilla.mozilla.org/show_bug.cgi?id=922896

            metaViewport = document.querySelector('meta[name=viewport]');
            if (metaViewport && (metaViewport.content.indexOf('user-scalable=no') !== -1 || document.documentElement.scrollWidth <= window.outerWidth)) {
                return true;
            }
        }

        // IE11: prefixed -ms-touch-action is no longer supported and it's recomended to use non-prefixed version
        // http://msdn.microsoft.com/en-us/library/windows/apps/Hh767313.aspx
        if (layer.style.touchAction === 'none' || layer.style.touchAction === 'manipulation') {
            return true;
        }

        return false;
    };


    /**
     * Factory method for creating a FastClick object
     *
     * @param {Element} layer The layer to listen on
     * @param {Object} [options={}] The options to override the defaults
     */
    FastClick.attach = function(layer, options) {
        return new FastClick(layer, options);
    };


    if (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {

        // AMD. Register as an anonymous module.
        define(function() {
            return FastClick;
        });
    } else if (typeof module !== 'undefined' && module.exports) {
        module.exports = FastClick.attach;
        module.exports.FastClick = FastClick;
    } else {
        window.FastClick = FastClick;
    }
}());
/**
 *
 *  @author      Johannes Axner <johannes.axner@hm.com>
 *  @copyright   Copyright (c) 2014 H&M
 *  @since       Version 2.0
 *
 */
(function (context, $) {
  'use strict';
  /**
   *
   * H&M Campaign external
   *
   * @returns external (self)
   */
  context.HTMLCampaign = function HTMLCampaign(options) {
    /************************************ external variables ************************************/
    var internal = {};
    var external = {};

    /*************************************** Constants ***************************************/

    external.ENVIRONMENT_JOSH = "JOSH";
    external.ENVIRONMENT_GOEP = "GOEP";
    external.DEVICE_DESKTOP = "desktop";
    external.DEVICE_TABLET = "tablet";
    external.DEVICE_MOBILE = "mobile";

    /**
     * Internal variables
     */
    internal.settings = {
      campaignId: options.campaignId,
      isLocal: (typeof _LOCAL_ === 'undefined' || _LOCAL_ !== true ? false : _LOCAL_),
      baseUrl: options.baseUrl,
      sdkBaseUrl: options.sdkBaseUrl
    };

    internal.callbacks = [];
    internal.pageLoadCallbacks = [];

    // Check environment, hm.bag is only present in Joshua
    if (hm && hm.bag) {
      internal.environment = external.ENVIRONMENT_JOSH;
    }
    else {
      internal.environment = external.ENVIRONMENT_GOEP;
    }

    external.baseUrl = internal.settings.baseUrl + 'resources/';
    external.pageBaseUrl = internal.settings.baseUrl + 'pages/';
    external.copyBaseUrl = internal.settings.baseUrl + 'copy';
    external.siteFiles = '/josh/static/site/';
    external.serviceBaseUrl = window.location.href.substring(0, window.location.href.search(/\/\w{2}\//i) + 1);
    external.config = {};

    options.device = options.device ? options.device.toLowerCase() : '';

    if (internal.environment === external.ENVIRONMENT_GOEP && options.device !== external.DEVICE_MOBILE && options.device !== external.DEVICE_DESKTOP && $('html').hasClass('touchevents') ) {
      internal.device = external.DEVICE_TABLET;
    }
    else if (!options.device || (options.device !== external.DEVICE_TABLET && options.device !== external.DEVICE_MOBILE)) {
      internal.device = external.DEVICE_DESKTOP;
    }
    else if (!options.device || (options.device !== external.DEVICE_DESKTOP && options.device !== external.DEVICE_MOBILE)) {
      internal.device = external.DEVICE_TABLET;
    }
    else {
      internal.device = external.DEVICE_MOBILE;
    }

    if (options.isLocal) {
      external.siteFiles = external.serviceBaseUrl + 'environment/site/';
      external.goepFiles = external.serviceBaseUrl + 'environment/goep/';
    }
    if (window.location.href.indexOf('akamai') > 0) {
      external.serviceBaseUrl = window.location.href.substring(0, window.location.href.search(/index\.php/i));
      external.siteFiles = external.serviceBaseUrl + 'environment/site/';
    }

    // For optimization
    internal.speedy = options.speedy || {};

    internal.campaignReady = false;
    internal.currentPage = '';

    internal.defaultLocale = "/en";

    internal.localeRules = {"ar_ae":["\/ar_ae"],"de_at":["\/de_at","\/de_de"],"en_au":["\/en_au"],"bg_bg":["\/bg_bg"],"ar_bh":["\/ar_bh"],"es_cl":["\/es_cl","\/es_es","\/en_us"],"es_co":["\/es_co","\/es_es"],"cs_cz":["\/cs_cz"],"en_cy":["\/en_cy"],"de_de":["\/de_de"],"de_ch":["\/de_ch","\/de_de"],"da_dk":["\/da_dk"],"ar_eg":["\/ar_eg"],"en_ca":["\/en_ca"],"en_cn":["\/en_cn"],"en_eur":["\/en_eur"],"en_gb":["\/en_gb"],"en_ie":["\/en_ie"],"es_es":["\/es_es"],"fi_fi":["\/fi_fi"],"sv_fi":["\/sv_fi","\/sv_se"],"fr_be":["\/fr_be","\/fr_fr"],"fr_ca":["\/fr_ca","\/fr_fr"],"fr_ch":["\/fr_ch","\/fr_fr"],"fr_fr":["\/fr_fr"],"zh_hk":["\/zh_hk","\/zh_cn"],"en_hk":["\/en_hk"],"hu_hu":["\/hu_hu"],"in_id":["\/in_id"],"iw_il":["\/iw_il"],"en_in":["\/en_in"],"it_ch":["\/it_ch","\/it_it"],"it_it":["\/it_it"],"ja_jp":["\/ja_jp"],"ar_jo":["\/ar_jo"],"ko_kr":["\/ko_kr"],"ar_kw":["\/ar_kw"],"ru_kz":["\/ru_kz","\/ru_ru"],"ar_lb":["\/ar_lb"],"ar_ma":["\/ar_ma"],"zh_mo":["\/zh_mo","\/zh_hk","\/zh_cn"],"en_mo":["\/en_mo"],"es_mx":["\/es_mx","\/es_es","\/en_us"],"ms_my":["\/ms_my"],"nl_nl":["\/nl_nl"],"nl_be":["\/nl_be","\/nl_nl"],"no_no":["\/no_no"],"en_nz":["\/en_nz"],"ar_om":["\/ar_om"],"es_pe":["\/es_pe","\/es_cl","\/es_es"],"en_ph":["\/en_ph","\/en_us"],"pl_pl":["\/pl_pl"],"pt_pt":["\/pt_pt"],"ar_qa":["\/ar_qa"],"ro_ro":["\/ro_ro"],"sr_rs":["\/sr_rs"],"ru_ru":["\/ru_ru"],"ar_sa":["\/ar_sa"],"sv_se":["\/sv_se"],"en_sg":["\/en_sg"],"sk_sk":["\/sk_sk"],"th_th":["\/th_th"],"tr_tr":["\/tr_tr"],"zh_tw":["\/zh_tw","\/zh_hk"],"en_tw":["\/en_tw","\/en_us"],"en_us":["\/en_us"],"en_za":["\/en_za"],"zh_cn":["\/zh_cn"]};

    /************************************ Event Callbacks ************************************/

    external.HASH_CHANGED = "CAMPAIGN::HashChanged";
    external.READY = "CAMPAIGN::Ready";
    external.ARTICLES_RETRIEVED = "API::ArticlesRetrieved";
    external.ARTICLES_PROGRESS = "API::ArticlesProgress";
    external.TIME_RETRIEVED = "API::TimeRetrieved";
    external.TEXTINFO_COMPLETE = "API::TextInfoComplete";
    external.STORELOCATOR_READY = "API::StoreLocatorReady";

    /************************************ internal methods ************************************/

    internal.createUrl = function createUrl(folder, page) {
      var url = external.pageBaseUrl + folder + '/' + page + '.html';
      url = url.replace(/\/\//g, '/')
        .replace(/\:\//, '://');
      url = external.pageBaseUrl.substring(0, 2) === '//' ? '/' + url : url;
      return url;
    };

    internal.getUrl = function getUrl(page, locale, defaultLocale, overrideLanguage) {
      if (typeof overrideLanguage !== 'undefined' && internal.checkIfUrlExists(internal.createUrl(overrideLanguage, page))) {
        return internal.createUrl(overrideLanguage, page);
      }
      var url = "",
        i;

      if (internal.localeRules && locale && internal.localeRules[locale] && internal.localeRules[locale].length) {
        for (i = 0; i < internal.localeRules[locale].length; i++) {
          url = internal.createUrl(internal.localeRules[locale][i], page);
          if (internal.checkIfUrlExists(url)) {
            return url;
          }
        }
        return internal.createUrl(defaultLocale, page);
      }
      else {
        hm.campaign.debug.warn('Can\'t get URL, locale not found!', locale);
        return null;
      }
    };

    internal.checkIfUrlExists = function checkIfUrlExists(url) {
      var exists;

      $.ajax({
        url: url,
        type: 'HEAD',
        async: false,
        error: function () {
          exists = false;
        },
        success: function () {
          exists = true;
        }
      });
      return exists;
    };

    external.loadPage = function loadPage(page, callback, overrideLanguage) {
      if (hm.campaign.api.video) {
        hm.campaign.api.video.resetInstances();
      }

      var locale = hm.campaign.api.locale.locale.toLowerCase();
      var url = internal.getUrl(page, locale, internal.defaultLocale, overrideLanguage);
      var suffix = ' #campaign > *';
      var $wrapper = $('#campaign_wrapper');

      // Load page
      $.ajax({
        url: url,
        dataType: 'text'
      })
        .done(function (data, textStatus, jqXHR) {
          var raw = data.replace(/\$\{baseUrl\}/gi, hm.campaign_data.base_url)
            .replace(/<!--([\s\S]*?)-->/mig, '');

          var $html = $(raw);
          var first = $wrapper.html() === '';
          var $container = $('#campaign');
          var a;

          internal.currentPage = page;
          if (page === 'index') {
            if ($container && $container.length) {
              // Find the content and add it to the container
              $html.each(function () {
                if (this.id && this.id === 'campaign') {
                  $html = $($(this)
                    .html());
                }
              });

              $container.empty()
                .append($html);
            }
            else {
              $html.each(function () {
                if (this.id && this.id === 'campaign') {
                  $(this)
                    .addClass(external.getEnvironment()
                      .toLowerCase())
                    .addClass(locale);

                  if (hm.campaign.api.locale.imageRestriction) {
                    $(this)
                      .addClass('altimg');
                  }
                }
              });

              // Just clear everything and add the content
              $wrapper.append($html);
            }
          }
          else {
            // Just add the content to the page
            $container.empty()
              .append($html);
          }
          external.widget.replace();
          callback.apply(null, new Array(data, page, textStatus, jqXHR));
        })
        .fail(function () {
          hm.campaign.debug.warn("Couldn't load page!", url);
        });
    };

    // before we do anything, load required api
    external.init = function init(config) {
      var page = 'index';

      $('#campaign_wrapper')
        .addClass(hm.campaign.getDevice());

      // Start campaign
      external.config = config || new CampaignConfig(hm.campaign_config);

      // Set up article loading
      external.config.data('productUrlGoep', typeof hm.campaign_data.productUrlGoep === 'undefined' || hm.campaign_data.productUrlGoep === '' ? '//www2.hm.com/' : hm.campaign_data.productUrlGoep);
      external.config.data('productUrlFetch', typeof hm.campaign_data.productUrlFetch === 'undefined' || hm.campaign_data.productUrlFetch === '' ? '//api.hm.com/' : hm.campaign_data.productUrlFetch);

      // Initialize needed classes
      external.utils = new CampaignUtils();
      external.api = new CampaignAPI(internal.settings, external.utils);
      external.widget = new CampaignWidget();
      external.statistics = new CampaignStatistics();

      // Inject CSS
      if (typeof internal.speedy.css === 'undefined' || internal.speedy.css === false) {
        external.utils.injectCSS(external.baseUrl + 'css/campaign.css');
      }

      external.loadPage(page, internal.onCampaignReady);
    };

    internal.onCampaignReady = function onCampaignReady() {
      internal.campaignReady = true;
      internal.setupStaticTexts();
      if (window.location.hash !== '') {
        hm.campaign.dispatchEvent(hm.campaign.READY);
      }
      else {
        external.dispatchEvent(external.READY);
      }

      hm.campaign.api.statistics.interactionReady();

      // Attach Selective FastClick if GOEP or Joshua-Tablet
      if (hm.campaign.getEnvironment() === hm.campaign.ENVIRONMENT_GOEP ||
        (hm.campaign.getEnvironment() == hm.campaign.ENVIRONMENT_JOSH && hm.campaign.isTouch())) {
        FastClick.attach(document.getElementById('campaign'));
      }

      // attach listener for hash changes
      window.onhashchange = internal.onHashChange;
    };

    internal.onHashChange = function onHashChange() {
      var page = window.location.hash.replace(/^#/, '');
      if (page === '') {
        page = 'index';
        internal.currentPage = page;
      }

      // check if incoming hash
      if (internal.pageLoad !== page) {
        internal.pageLoad = page;
        internal.currentPage = page;

        external.dispatchEvent(external.HASH_CHANGED, internal.pageLoad);
      }
    };

    external.version = '2.15.0';

    external.dispatchEvent = function dispatchEvent(eventName, data, params) {
      var callback,
        func;
      for (callback in internal.callbacks[eventName]) {
        if (internal.callbacks[eventName].hasOwnProperty(callback)) {
          func = internal.callbacks[eventName][callback];
          func.apply(null, [data, params]);
        }
      }
    };

    external.addEventListener = function addEventListener(eventName, callback) {
      if (typeof internal.callbacks[eventName] !== 'undefined') {
        internal.callbacks[eventName][internal.callbacks[eventName].length] = callback;
      }
      else {
        internal.callbacks[eventName] = new Array(callback);
      }
    };

    external.removeEventListener = function removeEventListener(eventName, callback) {
      if (typeof internal.callbacks[eventName] !== 'undefined') {
        delete internal.callbacks[eventName];
      }
    };

    /**
     * Display event specific store locator overlay
     *
     * @param {string} hybrisCampaignId  Hybris Campaign ID
     * @param {string} campaignConceptId Campaign Concept ID
     * @param {string} departmentId      Department ID
     * @param {string} departmentLabel   Department Label
     */
    external.storelocator = function storelocator(hybrisCampaignId, campaignConceptId, departmentId, departmentLabel) {
      hm.storelocatorevent.show({
        hybrisCampaignId: hybrisCampaignId,
        campaignConceptId: campaignConceptId,
        departmentId: departmentId,
        departmentLabel: departmentLabel
      });
    };

    external.isLocal = function isLocal() {
      if (internal.settings.isLocal) {
        return true;
      }
      else {
        return false;
      }
    };

    external.isReady = function isReady() {
      if (internal.campaignReady) {
        return true;
      }
      else {
        return false;
      }
    };

    external.getEnvironment = function getEnvironment() {
      return internal.environment;
    };

    external.isEnvironment = function isEnvironment(environment) {
      return external.getEnvironment() === environment;
    };

    external.getDevice = function getDevice() {
      return internal.device.toLowerCase();
    };

    external.isTouch = function isTouch() {
      return external.getDevice() === external.DEVICE_TABLET || external.getDevice() === external.DEVICE_MOBILE;
    };

    external.isDevice = function isDevice(device) {
      return external.getDevice() === device;
    };

    external.getCurrentPage = function getCurrentPage() {
      return internal.currentPage;
    };

    internal.setupStaticTexts = function setupStaticTexts() {
      if (typeof internal.staticTextsList[hm.campaign.api.locale.locale.toLowerCase()] !== 'undefined') {
        external.staticTexts = internal.staticTextsList[hm.campaign.api.locale.locale.toLowerCase()];
      }
      else {
        external.staticTexts = internal.staticTextsList.en;
      }
    };

    internal.staticTextsList = {
      'en': {
        'share': {
          'copyButtonLabel': 'COPY LINK',
          'mailButtonLabel': 'EMAIL'
        },
        'articleStatus': {
          'soldOut': 'Sold out',
          'comingSoon': 'Coming soon'
        }
      },
      'en_us': {
        'share': {
          'copyButtonLabel': 'COPY LINK',
          'mailButtonLabel': 'EMAIL'
        },
        'articleStatus': {
          'soldOut': 'Sold out',
          'comingSoon': 'Coming soon'
        }
      },
      'sv_se': {
        'share': {
          'copyButtonLabel': 'KOPIERA LÄNK',
          'mailButtonLabel': 'EMAIL'
        },
        'articleStatus': {
          'soldOut': 'Slutsåld',
          'comingSoon': 'Kommer snart'
        }
      },
      'sv_fi': {
        'share': {
          'copyButtonLabel': 'KOPIERA LÄNK',
          'mailButtonLabel': 'EMAIL'
        },
        'articleStatus': {
          'soldOut': 'Slutsåld',
          'comingSoon': 'Kommer snart'
        }
      },
      'zh_hk': {
        'share': {
          'copyButtonLabel': '\u8907\u88fd\u93c8\u63a5',
          'mailButtonLabel': '\u96fb\u5b50\u90f5\u7bb1'
        },
        'articleStatus': {
          'soldOut': '\u552e\u7f44',
          'comingSoon': '\u5feb\u5c07\u63a8\u51fa'
        }
      },
      'zh_cn': {
        'share': {
          'copyButtonLabel': '\u590d\u5236\u94fe\u63a5',
          'mailButtonLabel': '\u90ae\u4ef6'
        },
        'articleStatus': {
          'soldOut': '\u7f51\u7edc\u552e\u7a7a',
          'comingSoon': '\u5373\u5c06\u63a8\u51fa'
        }
      },
      'zh_tw': {
        'share': {
          'copyButtonLabel': '\u8907\u88fd\u93c8\u63a5',
          'mailButtonLabel': '\u96fb\u5b50\u4fe1\u7bb1'
        },
        'articleStatus': {
          'soldOut': '\u552e\u7f44',
          'comingSoon': '\u5feb\u5c07\u63a8\u51fa'
        }
      },
      'de_de': {
        'share': {
          'copyButtonLabel': 'LINK KOPIEREN',
          'mailButtonLabel': 'E-MAIL'
        },
        'articleStatus': {
          'soldOut': 'Ausverkauft',
          'comingSoon': 'Demnächst erhältlich'
        }
      },
      'de_at': {
        'share': {
          'copyButtonLabel': 'LINK KOPIEREN',
          'mailButtonLabel': 'E-MAIL'
        },
        'articleStatus': {
          'soldOut': 'Ausverkauft',
          'comingSoon': 'Demnächst erhältlich'
        }
      },
      'de_ch': {
        'share': {
          'copyButtonLabel': 'LINK KOPIEREN',
          'mailButtonLabel': 'E-MAIL'
        },
        'articleStatus': {
          'soldOut': 'Ausverkauft',
          'comingSoon': 'Demnächst erhältlich'
        }
      },
      'da_dk': {
        'share': {
          'copyButtonLabel': 'KOPIÉR LINK',
          'mailButtonLabel': 'E-MAIL'
        },
        'articleStatus': {
          'soldOut': 'Udsolgt',
          'comingSoon': 'Kommer snart'
        }
      },
      'es_es': {
        'share': {
          'copyButtonLabel': 'COPIAR ENLACE',
          'mailButtonLabel': 'CORREO ELECTRÓNICO'
        },
        'articleStatus': {
          'soldOut': 'Agotado',
          'comingSoon': 'Disponible muy pronto'
        }
      },
      'fi_fi': {
        'share': {
          'copyButtonLabel': 'KOPIOI LINKKI',
          'mailButtonLabel': 'SÄHKÖPOSTI'
        },
        'articleStatus': {
          'soldOut': 'Loppuunmyyty',
          'comingSoon': 'Tulossa pian.'
        }
      },
      'fr_ca': {
        'share': {
          'copyButtonLabel': 'COPIER LE LIEN',
          'mailButtonLabel': 'E-MAIL'
        },
        'articleStatus': {
          'soldOut': 'Épuisé',
          'comingSoon': 'Bientôt disponible'
        }
      },
      'fr_fr': {
        'share': {
          'copyButtonLabel': 'COPIER LE LIEN',
          'mailButtonLabel': 'E-MAIL'
        },
        'articleStatus': {
          'soldOut': 'Épuisé',
          'comingSoon': 'Bientôt disponible'
        }
      },
      'fr_ch': {
        'share': {
          'copyButtonLabel': 'COPIER LE LIEN',
          'mailButtonLabel': 'E-MAIL'
        },
        'articleStatus': {
          'soldOut': 'Épuisé',
          'comingSoon': 'Bientôt disponible'
        }
      },
      'it_it': {
        'share': {
          'copyButtonLabel': 'COPIA IL LINK',
          'mailButtonLabel': 'E-MAIL'
        },
        'articleStatus': {
          'soldOut': 'Esaurito',
          'comingSoon': 'Prossimamente'
        }
      },
      'it_ch': {
        'share': {
          'copyButtonLabel': 'COPIA IL LINK',
          'mailButtonLabel': 'E-MAIL'
        },
        'articleStatus': {
          'soldOut': 'Esaurito',
          'comingSoon': 'Prossimamente'
        }
      },
      'ja_jp': {
        'share': {
          'copyButtonLabel': '\u30ea\u30f3\u30af\u3092\u30b3\u30d4\u30fc',
          'mailButtonLabel': '\u30e1\u30fc\u30eb'
        },
        'articleStatus': {
          'soldOut': '\u54c1\u5207\u308c',
          'comingSoon': '\u307e\u3082\u306a\u304f\u5165\u8377'
        }
      },
      'ko_kr': {
        'share': {
          'copyButtonLabel': '\ub9c1\ud06c \ubcf5\uc0ac',
          'mailButtonLabel': '\uc774\uba54\uc77c'
        },
        'articleStatus': {
          'soldOut': '\ud488\uc808',
          'comingSoon': '\uace7 \ucd9c\uc2dc\ub420 \uc608\uc815\uc785\ub2c8\ub2e4.'
        }
      },
      'nl_be': {
        'share': {
          'copyButtonLabel': 'KOPIEER LINK',
          'mailButtonLabel': 'E-MAIL'
        },
        'articleStatus': {
          'soldOut': 'Online uitverkocht',
          'comingSoon': 'Binnenkort verkrijgbaar'
        }
      },
      'nl_nl': {
        'share': {
          'copyButtonLabel': 'KOPIEER LINK',
          'mailButtonLabel': 'E-MAIL'
        },
        'articleStatus': {
          'soldOut': 'Uitverkocht',
          'comingSoon': 'Binnenkort verkrijgbaar'
        }
      },
      'no_no': {
        'share': {
          'copyButtonLabel': 'KOPIERE LENKE',
          'mailButtonLabel': 'EPOST'
        },
        'articleStatus': {
          'soldOut': 'Utsolgt',
          'comingSoon': 'Kommer snart'
        }
      },
      'ru_ru': {
        'share': {
          'copyButtonLabel': '\u0421\u041a\u041e\u041f\u0418\u0420\u041e\u0412\u0410\u0422\u042c \u0421\u0421\u042b\u041b\u041a\u0423',
          'mailButtonLabel': '\u042d\u041b\u0415\u041a\u0422\u0420\u041e\u041d\u041d\u0410\u042f \u041f\u041e\u0427\u0422\u0410'
        },
        'articleStatus': {
          'soldOut': '\u0420\u0430\u0441\u043f\u0440\u043e\u0434\u0430\u043d\u043e',
          'comingSoon': '\u0421\u043a\u043e\u0440\u043e \u0432 \u043f\u0440\u043e\u0434\u0430\u0436\u0435'
        }
      },
      'tr_tr': {
        'share': {
          'copyButtonLabel': 'BAĞLANTIYI KOPYALA',
          'mailButtonLabel': 'EPOSTA'
        },
        'articleStatus': {
          'soldOut': 'Tükendi',
          'comingSoon': 'Çok yakında'
        }
      },
      'pl_pl': {
        'share': {
          'copyButtonLabel': 'SKOPIUJ LINK',
          'mailButtonLabel': 'E-MAIL'
        },
        'articleStatus': {
          'soldOut': 'Sold out',
          'comingSoon': 'Coming soon'
        }
      },
      'pt_pt': {
        'share': {
          'copyButtonLabel': 'COPIAR HIPERLIGAÇÃO',
          'mailButtonLabel': 'E-MAIL'
        },
        'articleStatus': {
          'soldOut': 'Sold out',
          'comingSoon': 'Coming soon'
        }
      },
      'cs_cz': {
        'share': {
          'copyButtonLabel': 'KOP\u00cdROVAT ODKAZ',
          'mailButtonLabel': 'E-MAIL'
        },
        'articleStatus': {
          'soldOut': 'Sold out',
          'comingSoon': 'Coming soon'
        }
      },
      'bg_bg': {
        'share': {
          'copyButtonLabel': '\u041a\u041e\u041f\u0418\u0420\u0410\u0419 \u0412\u0420\u042a\u0417\u041a\u0410\u0422\u0410',
          'mailButtonLabel': '\u0418\u041c\u0415\u0419\u041b'
        },
        'articleStatus': {
          'soldOut': 'Sold out',
          'comingSoon': 'Coming soon'
        }
      },
      'sk_sk': {
        'share': {
          'copyButtonLabel': 'SKOP\u00cdROVA\u0164 ODKAZ',
          'mailButtonLabel': 'EMAIL'
        },
        'articleStatus': {
          'soldOut': 'Sold out',
          'comingSoon': 'Coming soon'
        }
      },
      'ro_ro': {
        'share': {
          'copyButtonLabel': 'COPIERE LINK',
          'mailButtonLabel': 'E-MAIL'
        },
        'articleStatus': {
          'soldOut': 'Sold out',
          'comingSoon': 'Coming soon'
        }
      },
      'hu_hu': {
        'share': {
          'copyButtonLabel': 'HIVATKOZ\u00c1S M\u00c1SOL\u00c1SA',
          'mailButtonLabel': 'E-MAIL'
        },
        'articleStatus': {
          'soldOut': 'Sold out',
          'comingSoon': 'Coming soon'
        }
      }
    };

    external.debug = {
      'handler': function handler(method, parameters) {
        if (hm.campaign.isLocal() && console && typeof console.hasOwnProperty !== 'undefined' && console.hasOwnProperty(method)) {
          console[method].apply(window, parameters);
        }
      },
      'assert': function assert() {
        external.debug.handler('assert', arguments);
      },
      'clear': function clear() {
        external.debug.handler('clear', arguments);
      },
      'count': function count() {
        external.debug.handler('count', arguments);
      },
      'debug': function debug() {
        external.debug.handler('debug', arguments);
      },
      'dir': function dir() {
        external.debug.handler('dir', arguments);
      },
      'dirxml': function dirxml() {
        external.debug.handler('dirxml', arguments);
      },
      'error': function error() {
        external.debug.handler('error', arguments);
      },
      'exception': function exception() {
        external.debug.handler('exception', arguments);
      },
      'group': function group() {
        external.debug.handler('group', arguments);
      },
      'groupCollapsed': function groupCollapsed() {
        external.debug.handler('groupCollapsed', arguments);
      },
      'groupEnd': function groupEnd() {
        external.debug.handler('groupEnd', arguments);
      },
      'info': function info() {
        external.debug.handler('info', arguments);
      },
      'log': function log() {
        external.debug.handler('log', arguments);
      },
      'profile': function profile() {
        external.debug.handler('profile', arguments);
      },
      'profileEnd': function profileEnd() {
        external.debug.handler('profileEnd', arguments);
      },
      'table': function table() {
        external.debug.handler('table', arguments);
      },
      'time': function time() {
        external.debug.handler('time', arguments);
      },
      'timeEnd': function timeEnd() {
        external.debug.handler('timeEnd', arguments);
      },
      'timeStamp': function timeStamp() {
        external.debug.handler('timeStamp', arguments);
      },
      'trace': function trace() {
        external.debug.handler('trace', arguments);
      },
      'warn': function warn() {
        external.debug.handler('warn', arguments);
      }
    };

    external.hideNativeLoader = function hideNativeLoader() {
      if (external.getEnvironment() === external.ENVIRONMENT_JOSH) {
        return $('body')
          .removeClass('loading');
      }
      else {
        var remove_goep_loader = function (event) {
          if ($('#campaign_wrapper > .loader')
              .length) {
            $('#campaign_wrapper > .loader')
              .hide();
            clearInterval(loader_interval);
          }
        };
        var loader_interval = setInterval(remove_goep_loader, 50);
        remove_goep_loader();
      }
    };

    return external;
  };
})(this, jQuery);

/**
 *
 *  @author      Johannes Axner <johannes.axner@hm.com>
 *  @copyright   Copyright (c) 2012 H&M
 *  @since       Version 1.0
 *
 */

(function (exports) {
    'use strict';
    /**
     *
     * H&M Campaign Statistics Public
     *
     * @returns external (self)
     */
    exports.CampaignUtils = function CampaignUtils() {
        var internal = {};
        var external = {};

        internal.locale_regex_josh = /(\/(\w{2})\/(\w{2})\/|\/(\w{2})\/)/i;
        internal.locale_regex_goep = /\/(\w{2})_(\w{2,3})\//i;

        /**
         * Internal function for fetching the document path
         */
        internal.getPath = function getPath() {
            return location.pathname.replace(/^\/\/+/i, '/');
        };

        /**
         * A generic way to get the location prefix from the URL of the document
         */
        external.getUrlPrefix = function getUrlPrefix() {
            var locale;
            if (hm.campaign.getEnvironment() === hm.campaign.ENVIRONMENT_JOSH) {
                if (hm.campaign.isLocal()) {
                    locale = internal.getPath()
                        .match(internal.locale_regex_josh);
                    locale = (locale) ? locale[1].replace(new RegExp('/$'), '') : null;
                }
                else {
                    locale = hm.url.getLocalizationUrlPrefix();
                }
            }
            else {
                locale = internal.getPath()
                    .match(internal.locale_regex_goep);
                if (locale && locale.length) {
                    locale = locale[0].replace(/\//g, '');
                }
                else {
                    locale = '';
                }
            }
            return locale;
        };

        /**
         * Injects an element into the page
         * @param {string} target		Target element to append to
         * @param {string} tag 			Which tag to inject
         * @param {object} attributes	Key value pairs for attributes and their values
         */
        internal.injectElement = function injectElement(target, tag, attributes) {
            return (function (d, element) {
                var attribute;
                element = d.createElement(tag);
                for (attribute in attributes) {
                    if (attributes.hasOwnProperty(attribute)) {
                        element[attribute] = attributes[attribute];
                    }
                }
                return d.getElementsByTagName(target)[0].appendChild(element);
            }(document));
        };

        /**
         * Injects a link tag in the head of the document pointing to the given CSS file
         * @param {string} url URL to CSS file to inject
         */
        external.injectCSS = function injectCSS(url) {
            return internal.injectElement('head', 'link', {
                'type': 'text/css',
                'rel': 'stylesheet',
                'media': 'all',
                'href': url
            });
        };

        /**
         * Injects a link tag at the end of the body of the document pointing to the given JS file
         * @param {string} url URL to JS file to inject
         */
        external.injectJS = function injectJS(url) {
            return internal.injectElement('body', 'script', {
                'type': 'text/javascript',
                'src': url
            });
        };

        // return external methods and settings
        return external;
    };
})(this);

/**
 *
 *  @author      Mikael X Johansson
 *  @author      Johannes Axner <johannes.axner@hm.com>
 *  @copyright   Copyright (c) 2013 H&M
 *  @since       Version 1.0
 *
 */

(function (exports) {
    'use strict';
    /**
     *
     * H&M Campaign public
     *
     * @memberOf hm.campaign
     * @name article
     * @class
     * @returns CampaignConfig
     */
    var CampaignConfig = function CampaignConfig(config) {
        /************************************ Public variables ************************************/
        /**
         * @private
         */
        var internal = {};
        var external = {};

        internal.config = hm.campaign_config;

        /************************************ Public methods ************************************/

        /**
         * <br/>Load articles from backend to the framework. All articles must be loaded or attempted to be loaded before using their aliases.
         *
         * @memberOf hm.campaign.api.article
         * @name loadArticles
         * @function
         *
         * @param {Array} aliases. An array of aliases to load from backend.
         */
        external.data = function data(key, value) {
            if (typeof value !== 'undefined') {
                internal.config[key] = value;
            }

            if (typeof internal.config[key] !== 'undefined') {
                return internal.config[key];
            }

            return null;
        };

        return external;
    };

    window.CampaignConfig = CampaignConfig;

})(this);

/**
 *
 *  @author      Mikael X Johansson
 *  @author      Johannes Axner <johannes.axner@hm.com>
 *  @copyright   Copyright (c) 2012 H&M
 *  @since       Version 1.0
 *
 */

(function (exports, $) {
    /**
     *
     * H&M Campaign Statistics public
     *
     * @returns public (self)
     */
    CampaignStatistics = function () {
        var internal = {};
        var external = {};

        /************************************ public variables ***********************************/
        internal.seperator = ' : ';

        /************************************ private methods ***********************************/

        /************************************ Public methods ************************************/

        /**
         * Will track the incoming "page" to CoreMetrics
         * @param category
         * @param trackIdentifier
         * Example   trackPage('K43 ALL FOR CHILDREN', 'EN : TEST : MAINPAGE')
         */
        external.trackPage = function (category, trackIdentifier) {
            if (typeof utag === 'object' && typeof utag.view === 'function') {
                if (hm.campaign.api.locale.locale.toLowerCase() === 'en_eur'){
                    utag.view({
                        'page_id': trackIdentifier,
                        'page_category': category
                    });
                } else {
                    utag.view({
                        'page_id': trackIdentifier,
                        'page_category': category,
                        'session_market': hm.campaign.api.locale.country,
                        'session_locale': hm.campaign.api.locale.locale
                    });
                }
            }
        };

        /**
         * Will track the incoming "Element" interaction to CoreMetrics
         * @param category
         * @param trackIdentifier
         * @param element
         * Example   trackElement('K43 ALL FOR CHILDREN', 'EN : TEST : MAINPAGE', 'IMAGE 2')
         */
        external.trackElement = function (category, trackIdentifier, element) {
            var trackString = trackIdentifier;
            if (element) {
                trackString += internal.seperator + element;
            }
            if (typeof utag === 'object' && typeof utag.link === 'function') {
                utag.link({
                    'event_id': trackString,
                    'event_category': category,
                    'event_type': 'freeformcampaign_click'
                });
            }            
        };

        // return public methods and settings
        return external;
    };

    exports.Plugin = CampaignStatistics;

})(this, jQuery);


// Create campaign object
hm.campaign = new HTMLCampaign({
    "isLocal": hm.campaign_data.is_local,
    "baseUrl": hm.campaign_data.base_url,
    "sdkBaseUrl": hm.campaign_data.sdk_base_url,
    "device": hm.campaign_data.device,
    "productUrlGoep": hm.campaign_data.productUrlGoep,
    "productUrlFetch": hm.campaign_data.productUrlFetch,
    "speedy": hm.campaign_data.speedy
});

/**
 *  @author    Johannes Axner <johannes.axner@hm.com>
 *  @author    Linda Wagnerius <linda.wagnerius@hm.com>
 *  @author    Simon Nkangi <simon.nkangi@hm.com>
 *  @copyright Copyright (c) 2015 H&M
 *  @since     Version 2.0
 *
 */
(function (exports, $) {
    'use strict';
    /**
     *
     * H&M HTML Framework Campaign Widget
     * @name hm.campaign.Widget
     * @class
     * @returns {Widget} An instance of hm.campaign.Widget.
     */
    var CampaignWidget = function () {
        /************************************ Public variables ************************************/
        var internal = {};
        var external = {};

        /************************************ Private variables ************************************/

        /************************************ Constants variables ************************************/

        internal.VERSION = '1.10';

        /************************************ Private methods ************************************/
        internal.init = function init() {
            // Instanciate the widgets
            if (typeof PriceWidget === 'function') {
                external.priceWidget = new PriceWidget();
            }

            if (typeof QuicklookWidget === 'function') {
                external.quicklookWidget = new QuicklookWidget();
            }

            if (typeof CampaignLoaderWidget === 'function') {
                external.loaderWidget = new CampaignLoaderWidget();
            }
        };

        /************************************ Public methods ************************************/

        /**
         * Calling this function will render all the widgets that are currently in the DOM.
         */
        external.replace = function ($target) {
            // Instanciate the widgets
            if (typeof external.priceWidget === 'object') {
                external.priceWidget.run();
            }
            if (typeof external.quicklookWidget === 'object') {
                external.quicklookWidget.run();
            }
            if (typeof external.loaderWidget === 'object') {
                external.loaderWidget.run();
            }
        };

        internal.init();

        return external;
    };

    window.CampaignWidget = CampaignWidget;

})(window, jQuery);

/**
 *  @author    Johannes Axner <johannes.axner@hm.com>
 *  @author    Linda Wagnerius <linda.wagnerius@hm.com>
 *  @author    Simon Nkangi <simon.nkangi@hm.com>
 *  @copyright Copyright (c) 2015 H&M
 *  @since     Version 2.0
 */
(function (exports, $) {
    'use strict';
    /**
     * Spinning loader widget.
     *
     * @memberOf hm.campaign.Widget
     * @name LoaderWidget
     * @class
     * @returns {LoaderWidget} An instance of hm.campaign.Widget.LoaderWidget.
     */
    exports.CampaignLoaderWidget = function () {
        /**
         * @memberOf hm.campaign.Widget
         * @private
         */
        var internal = {};

        /**
         * @memberOf hm.campaign.Widget
         * @private
         */
        var external = {};

        /**
         * @memberOf hm.campaign.Widget
         * @private
         */
        internal.elementId = null;

        /**
         * @memberOf hm.campaign.Widget
         * @private
         */

        internal.rawSpinner = 'url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20132%20132%22%3E%3Cpath%20fill%3D%22__COLOR__%22%20d%3D%22M68%2014c0%201.104-.896%202-2%202s-2-.896-2-2V2c0-1.104.896-2%202-2s2%20.896%202%202%22%2F%3E%3Cpath%20opacity%3D%220.58%22%20fill%3D%22__COLOR__%22%20d%3D%22M64%20118c0-1.104.896-2%202-2s2%20.896%202%202v12c0%201.104-.896%202-2%202s-2-.896-2-2%22%2F%3E%3Cpath%20opacity%3D%220.79%22%20fill%3D%22__COLOR__%22%20d%3D%22M14%2064c1.104%200%202%20.896%202%202s-.896%202-2%202H2c-1.104%200-2-.896-2-2s.896-2%202-2%22%2F%3E%3Cpath%20opacity%3D%220.37%22%20fill%3D%22__COLOR__%22%20d%3D%22M118.001%2067.999c-1.104%200-2-.896-2-1.999%200-1.104.895-2%202-2H130c1.104%200%202%20.896%202%202s-.896%202-2%202%22%2F%3E%3Cpath%20opacity%3D%220.75%22%20fill%3D%22__COLOR__%22%20d%3D%22M15.927%2080.167c1.05-.341%202.179.234%202.52%201.284.341%201.05-.234%202.179-1.284%202.521L5.75%2087.679c-1.05.341-2.179-.234-2.52-1.284-.341-1.049.233-2.179%201.284-2.52%22%2F%3E%3Cpath%20opacity%3D%220.33%22%20fill%3D%22__COLOR__%22%20d%3D%22M116.073%2051.832c-1.05.341-2.178-.234-2.519-1.283-.341-1.05.233-2.178%201.284-2.52l11.412-3.708c1.05-.341%202.179.233%202.52%201.284.341%201.049-.234%202.178-1.284%202.52%22%2F%3E%3Cpath%20opacity%3D%220.96%22%20fill%3D%22__COLOR__%22%20d%3D%22M51.833%2015.927c.341%201.05-.234%202.179-1.284%202.52-1.05.341-2.179-.234-2.521-1.284L44.321%205.75c-.341-1.05.234-2.179%201.284-2.52%201.049-.341%202.179.233%202.52%201.284%22%2F%3E%3Cpath%20opacity%3D%220.54%22%20fill%3D%22__COLOR__%22%20d%3D%22M80.167%20116.073c-.341-1.05.234-2.179%201.284-2.52%201.05-.341%202.179.234%202.521%201.284l3.708%2011.413c.341%201.05-.234%202.179-1.284%202.52-1.049.341-2.179-.233-2.52-1.284%22%2F%3E%3Cpath%20opacity%3D%220.92%22%20fill%3D%22__COLOR__%22%20d%3D%22M37.053%2022.756c.649.894.451%202.145-.442%202.793-.893.649-2.145.451-2.794-.443l-7.053-9.708c-.649-.894-.451-2.145.442-2.793s2.145-.451%202.794.442%22%2F%3E%3Cpath%20opacity%3D%220.49%22%20fill%3D%22__COLOR__%22%20d%3D%22M94.947%20109.244c-.649-.894-.451-2.145.442-2.793.893-.649%202.145-.451%202.793.443l7.054%209.708c.649.894.451%202.145-.442%202.793s-2.145.451-2.794-.442%22%2F%3E%3Cpath%20opacity%3D%220.71%22%20fill%3D%22__COLOR__%22%20d%3D%22M22.756%2094.947c.894-.649%202.145-.451%202.793.442.649.893.451%202.145-.443%202.794l-9.708%207.053c-.894.649-2.145.451-2.793-.442s-.451-2.145.442-2.794%22%2F%3E%3Cpath%20opacity%3D%220.28%22%20fill%3D%22__COLOR__%22%20d%3D%22M109.244%2037.051c-.894.649-2.144.451-2.792-.442s-.451-2.144.442-2.793l9.708-7.053c.894-.649%202.145-.451%202.793.442.648.893.451%202.144-.443%202.793%22%2F%3E%3Cpath%20opacity%3D%220.66%22%20fill%3D%22__COLOR__%22%20d%3D%22M33.817%20106.894c.649-.894%201.9-1.091%202.793-.443.893.649%201.092%201.9.442%202.794L30%20118.953c-.649.894-1.901%201.091-2.794.442-.893-.648-1.091-1.9-.442-2.793%22%2F%3E%3Cpath%20opacity%3D%220.24%22%20fill%3D%22__COLOR__%22%20d%3D%22M98.182%2025.105c-.649.894-1.899%201.091-2.792.443-.893-.649-1.091-1.899-.442-2.793L102%2013.047c.649-.894%201.9-1.092%202.793-.443.893.649%201.091%201.9.442%202.793%22%2F%3E%3Cpath%20opacity%3D%220.87%22%20fill%3D%22__COLOR__%22%20d%3D%22M25.106%2033.817c.894.649%201.091%201.9.443%202.793-.649.893-1.9%201.092-2.794.442L13.047%2030c-.894-.649-1.091-1.901-.442-2.794.648-.893%201.9-1.091%202.793-.442%22%2F%3E%3Cpath%20opacity%3D%220.45%22%20fill%3D%22__COLOR__%22%20d%3D%22M106.894%2098.183c-.894-.649-1.091-1.9-.443-2.793.649-.893%201.9-1.092%202.794-.442l9.708%207.053c.894.649%201.091%201.901.442%202.794-.648.893-1.9%201.092-2.793.442%22%2F%3E%3Cpath%20opacity%3D%220.62%22%20fill%3D%22__COLOR__%22%20d%3D%22M48.029%20114.837c.341-1.05%201.47-1.625%202.52-1.284%201.05.341%201.625%201.47%201.284%202.52l-3.708%2011.413c-.341%201.05-1.47%201.625-2.52%201.284-1.05-.341-1.625-1.47-1.284-2.52%22%2F%3E%3Cpath%20opacity%3D%220.2%22%20fill%3D%22__COLOR__%22%20d%3D%22M83.97%2017.162c-.341%201.05-1.469%201.625-2.519%201.284-1.05-.341-1.625-1.469-1.284-2.52l3.708-11.412c.341-1.05%201.47-1.625%202.52-1.284%201.05.341%201.625%201.47%201.284%202.52%22%2F%3E%3Cpath%20opacity%3D%220.83%22%20fill%3D%22__COLOR__%22%20d%3D%22M17.163%2048.029c1.05.341%201.625%201.47%201.284%202.52-.341%201.05-1.47%201.625-2.52%201.284L4.514%2048.125c-1.05-.341-1.625-1.47-1.284-2.52.341-1.05%201.47-1.625%202.52-1.284%22%2F%3E%3Cpath%20opacity%3D%220.41%22%20fill%3D%22__COLOR__%22%20d%3D%22M114.837%2083.971c-1.05-.341-1.625-1.47-1.284-2.52.341-1.05%201.47-1.625%202.52-1.284l11.413%203.708c1.05.341%201.625%201.47%201.284%202.52-.341%201.05-1.47%201.625-2.52%201.284%22%2F%3E%3C%2Fsvg%3E")';
        internal.rawLogo = 'url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22136%22%20height%3D%2290%22%3E%3Cpath%20fill%3D%22__COLOR__%22%20fill-rule%3D%22evenodd%22%20d%3D%22M95.6%202.7c5-2.4%207.4-2%207.4.4%200%203.3-.4%207.6-.7%2010.7-2%2016.8-5%2030.4-5.2%2047.7%208.2-21%2015-35.5%2023.7-53.5%202.7-5.8%204.6-4.8%206.8-5.8%209-4%209.2-1.5%208%203.4-4.3%2017.8-15.2%2074.2-17%2082.8-.4%202.5-3.2%201.5-3.8.5-3.3-4.5-6.8-4.5-6.4-7.5%202-14.3%209.2-50.7%2011-59.2C109.8%2041.7%20100%2066%2095%2079.8c-1%203-3%202.7-4.2.5-1.8-3-5-4.6-5.5-8-1.8-11.4%202-33%202.4-46.6-5%2015-13.7%2044-17.5%2057-1.6%205.3-6.8%204.4-5.4-.8%205.8-22%2018-60.8%2023.5-74.7C89.5%204%2093%204%2095.6%202.7zM64.3%200c-1.7-.3-6.6%202.3-9.6%202.7-1%20.3-1.8%201.2-2.2%202-4.7%2011-9%2021.5-12.6%2031-5%20.8-10.4%202-16.6%203.2L36.6%205.4C38.8%200%2033-.5%2031%205c-3%207-8.2%2020.2-14%2035.5-4.5%201-9.2%202.2-14%203.7-3.5%201-3.6%202-2%204%20.8%201%202.4%201%203.2%202%202%202%203.4%204.6%207%205C8%2064%204.7%2073%201.8%2081.7c-2%205.4%203.5%206.6%205.5.8%203.3-9.3%206.7-18.7%2010.3-28.2%203-.6%2010-2%2016.6-3.6-5%2014.5-8.5%2025.3-9.8%2030.7-.3%201%20.2%201.5.4%202%201.7%202.5%203.4%202.7%205.7%206%20.6.8%202.6%201.2%203.4-1C38.5%2073.8%2043.4%2060%2048%2047.7c2-.5%205.5-1.3%207.7-4.4%203.7-5.7%204.8-4.6%205.8-6.3%201-2.3.3-4.2-3.7-3.8l-4.4.5C58%2022%2062%2012.4%2064.7%205c1-2.7%201-4.6-.4-5z%22%20clip-rule%3D%22evenodd%22%2F%3E%3Cpath%20fill%3D%22__COLOR__%22%20fill-rule%3D%22evenodd%22%20d%3D%22M60%2071.6l1.6-2.5c2.4-3.4%200-5.5-2.3-3.4l-1%201c-.5-1.2-1-2.5-1.3-3.8%201-1.3%202.2-2.7%203-4.2%204-6-3.6-9.6-7-5.7-1.7%202-1.3%204-.8%206L53%2061c-1%201-2.2%202.2-3.7%204-3.8%204.4-2.7%2010%201.3%2011.3%202.4.7%204.7-.4%206.7-2l.3.6c1%202.7%204.4%202%203-1.3l-.7-2zM54.3%2066l1%203.2-1.3%201c-1.5%201-2.6%200-.6-2.8l1-1.3zm1.3-7.7c0-.3-.2-.5-.3-.8-1-4.2%203.7-3%201.3-.3l-1%201z%22%20clip-rule%3D%22evenodd%22%2F%3E%3C%2Fsvg%3E")';
        internal.rawHtml = '<div class="hm-campaign-loader"><div class="spinner"></div></div>';
        internal.defaultColor = "#cd2026";

        /**
         * Iterates through each element in the DOM that has both the class "campaign-widget" and the class "campaign-loader".
         * Each of these DOM elements will be replaced with a Loader Widget.
         *
         * @memberOf hm.campaign.Widget.LoaderWidget
         * @name run
         * @function
         * @returns {LoaderWidget} It's own instance of hm.campaign.Widget.LoaderWidget.
         * @example <caption>Parses markup as the following into a loader widget</caption>
         * <div class="campaign-widget campaign-loader" data-color="#E81D2C" data-withlogo="true"></div>
         * @example <caption>Data Attributes</caption>
         * data-color (hex value) [required] - sets the loader color
         * data-withlogo (boolean) - if true the H&M logo is shown
         */
        external.run = function () {
            $('.campaign-widget.campaign-loader')
                .each(function () {
                    internal.createLoaderWidget($(this), $(this)
                        .data('color'), $(this)
                        .data('withlogo'));
                });
            return this;
        };

        /************************************ Private methods ************************************/
        /**
         * @private
         */
        internal.init = function () {
            // Texts will be replaced at hm.campaign.api.texts.data.greeting
        };

        /**
         * Creates and returns a loaderWidget as a jQuery object.
         * @memberOf hm.campaign.Widget.LoaderWidget
         * @param {Object} holder						The holder element.
         * @param {String} id							The created widget id.
         * @param {String} [customColor="#000000"]		The color of the loader.
         * @param {Boolean} [withLogo=false]				To display the H&amp;M logo in the loader or not.
         * @name create
         * @function
         * @returns {LoaderWidget} It's own instance of hm.campaign.Widget.LoaderWidget.
         * @example <caption>Creates the html snippet</caption>
         *
         * <div class="campaign-widget campaign-loader" data-color="#E81D2C" data-withlogo="true"></div>
         */
        external.create = function (holder, id, color, withLogo) {
            // build html snippet to append
            var widget = $("<div/>")
                .attr('id', id)
                .data('color', color)
                .data('withlogo', withLogo)
                .addClass('campaign-widget')
                .addClass('campaign-loader');

            // append to holder
            $(holder)
                .append(widget);

            // run widget parser
            return external.run();
        };

        /**
         * Nulls all object references and internal variables in order to make this instance eligible for garbage collection.
         *
         * @memberOf hm.campaign.Widget.LoaderWidget
         * @name destroy
         * @function
         */
        external.destroy = function destroy() {
            // Destroy elements
            var $loader = $('.hm-campaign-loader');
            $loader.remove();

            // Destroy objects
            internal.elementId = null;
        };

        external.update = function update($loader, color, withLogo) {
            if (!$loader.hasClass('hm-campaign-loader')) {
                return;
            }
            internal.setColor($loader, color, withLogo);
        };

        internal.safeColor = function safeColor(color) {
            // Only accept valid string lengths
            color = (typeof (color) !== "undefined" && (color.length === 7 || color.length === 4)) ? color : internal.defaultColor;

            // only accept valid HEX characters 0-1, a-f
            if (!(/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(color))) { // If true - invalid characters are included
                color = internal.defaultColor;
            }

            return color.replace(/#/, '%23');
        };

        internal.setColor = function setColor($loader, color, withLogo) {
            color = internal.safeColor(color);
            $loader.find('.spinner')
                .css('background-image', internal.rawSpinner.replace(/__COLOR__/g, color));

            if (withLogo) {
                $loader.css('background-image', internal.rawLogo.replace(/__COLOR__/g, color));
            }
            else {
                $loader.css('background-image', '');
            }
        };

        /**
         * Create the html snippet
         * @memberOf hm.campaign.Widget.LoaderWidget
         * @private
         * @param String alias - The article alias
         */
        internal.createLoaderWidget = function (element, color, withLogo) {

            var $loader = $(internal.rawHtml);

            internal.setColor($loader, color, withLogo);

            $(element)
                .replaceWith($loader);
        };
        internal.init();

        return external;
    };
})(this, jQuery);

/**
 *  @author    Johannes Axner <johannes.axner@hm.com>
 *  @author    Linda Wagnerius <linda.wagnerius@hm.com>
 *  @author    Simon Nkangi <simon.nkangi@hm.com>
 *  @copyright Copyright (c) 2015 H&M
 *  @since     Version 2.0
 */
(function (exports, $) {
  'use strict';
  /**
   * Price label widget.
   *
   * @memberOf hm.campaign.Widget
   * @name PriceWidget
   * @class
   * @returns {PriceWidget} An instance of hm.campaign.Widget.PriceWidget.
   */
  exports.PriceWidget = function () {
    /************************************ Public variables ************************************/
    /**
     * @private
     */
    var internal = {};
    var external = {};

    /************************************ Private variables ************************************/
    /**
     * @private
     */
    internal.availableOptions = ['freetext', 'size', 'productname', 'designer'];


    /************************************ Constants variables ************************************/

    /************************************ Public methods ************************************/

    /**
     * Iterates through each element in the DOM that has both the class "campaign-widget" and the class "campaign-price".
     * Each of these DOM elements will be replaced with a price Widget.
     *
     * @memberOf hm.campaign.Widget.PriceWidget
     * @name run
     * @function
     * @example <caption>Parses markup as the following into a price widget</caption>
     * <div class="campaign-widget campaign-price" data-alias="article-11"></div>
     */
    external.run = function () {
      $('.campaign-widget.campaign-price')
        .each(function () {
          if (hm.campaign.api.article.isArticleAvailable($(this)
              .data('alias'))) {
            internal.createPriceWidget($(this), $(this)
              .data('alias'), $(this)
              .data('align'), $(this)
              .data('freetext'), $(this)
              .data('layout'), $(this)
              .data('color'), $(this)
              .data('hideoptions'));
          }
          else {
            // hm.campaign.debuginfo.warn('Price Widget: article ' + $(this).data('alias') + ' not loaded');
          }
        });

      $('.campaign-widget.campaign-price-small')
        .each(function () {
          if (hm.campaign.api.article.isArticleAvailable($(this)
              .data('alias'))) {
            internal.createSmallPriceWidget($(this), $(this)
              .data('alias'), $(this)
              .data('align'), $(this)
              .data('freetext'), $(this)
              .data('layout'), $(this)
              .data('color'), $(this)
              .data('hideoptions'));
          }
          else {
            // hm.campaign.debuginfo.warn('Price Widget: article ' + $(this).data('alias') + ' not loaded');
          }
        });

      return this;
    };

    /**
     * Creates and returns a PriceWidget as a jQuery object.
     * @param {Object} holder           The holder element.
     * @param {String} id               The created widget id.
     * @param {String} alias                The alias of the product which the price widget is asociated with.
     * @param {Boolean} [priceOnly]     The price component displays only price information (and hides the rest) if set to true. Defaults to: false.
     * @param {String} [size="small"]   The physical size of the price widget. Can be one of the following values: "small", "medium" or "large".
     * @param {String} [align]          Text alignment (i.e. "right to left" or "left to right". Possible value "right" or "left". Defaults to "right". Right = RTL, Left = LTR.
     * @param {String} [text]           Extra text that will be displayed within the price component.
     * @param {String} [layout]         Text layout direction. Possible values: "vertical" or "horizontal". Defaults to "vertical".
     * @param {String} [customColor]        Sets the text color of the PriceWidget. Accepts a css-hex color. Including the sharp-sign. E.g. "#333333".
     * @param {String} [hideoptions]    Hide option(s), possible values "freetext", "size", "productname" and/or "designer".
     *
     * @memberOf hm.campaign.Widget.PriceWidget
     * @name create
     * @function
     * @example <caption>Creates the html snippet</caption>
     *
     * <div class="hm-price">
     *  <a href="#">article-12</a>
     *  <p>
     *      <span class="hm-price-from">från</span>
     *      <span class="hm-price-new">49:50</span>
     *      <span class="hm-price-old">99:-</span>
     *  </p>
     *  <p>
     *      <span class="hm-price-size">Free text</span>
     *  </p>
     *  <p>
     *      <span class="hm-price-size">S-XL</span>
     *  </p>
     *</div>
     */
    external.create = function (holder, id, alias, priceOnly, size, align, text, layout, customColor, hideoptions) {
      // build html snippet to append
      var widget = $("<div/>")
        .attr('id', id)
        .data('alias', alias)
        .data('align', align)
        .data('layout', layout)
        .data('freetext', text)
        .data('color', customColor)
        .data('hideoptions', hideoptions)
        .addClass('campaign-widget')
        .addClass('campaign-price')
        .addClass(size);

      if (priceOnly) {
        widget.attr('class', widget.attr('class') + ' price-only');
      }

      // append to holder
      $(holder)
        .append(widget);

      // run widget parser
      return external.run();
    };

    /************************************ Private methods ************************************/
    /**
     * @private

     */
    internal.init = function () {
      // Texts will be replaced at hm.campaign.api.texts.data.greeting

    };

    /**
     * Create the html snippet
     * @private
     * @param String alias - The article alias
     */
    internal.createPriceWidget = function (element, alias, align, text, layout, customColor, hideoptions) {
      var color = (typeof (customColor) === "undefined") ? "#333333" : customColor;
      var alignment = (typeof (align) === "undefined") ? "left" : align;
      var freeText = (typeof (text) === "undefined") ? "" : text;
      var textLayout = (typeof (layout) === "undefined") ? "vertical" : layout;
      var hideoptions = (typeof hideoptions !== 'undefined') ? hideoptions.split(/[ ]+/) : [];

      internal.element = $(element);

      // textholders
      var articleName, moreinfoRow, designerRow, freeTextRow, priceFromText, priceNewText, priceOldText, priceText, sizeText, sizeRow, priceRow;

      // Fetch the specific article. The articles are assumed to be preloaded
      var article = hm.campaign.api.article.getArticleByAlias(alias);

      internal.validateArray(hideoptions);
      /**
       * Start setting up all html elements needed
       **/
      if (!(internal.element.hasClass('price-only')) && internal.findOptionInArray('productname', hideoptions)) {
        articleName = internal.baseObject('a', 'hm-article', article.localizedName)
          .css('color', color);
        articleName[0].href = article.url;
      }

      priceRow = $("<a/>");
      priceRow.addClass('price-row');
      priceRow.attr('href', article.url);


      /** Price From */
      if (article.prePriceInfo !== '') {
        priceFromText = internal.baseObject('span', 'hm-price-from', article.prePriceInfo)
          .css('text-align', alignment)
          .css('color', color);

        priceRow.append(priceFromText);
      }

      var localizedPriceString = article.localizedPriceString;
      var localizedOldPriceString = article.localizedOldPriceString;

      if (typeof hm.campaign.api.locale.countryInfo.decimals !== 'undefined' && hm.campaign.api.locale.countryInfo.decimals === '2') {
        localizedPriceString = internal.getDoubleDigit(article.localizedPriceString);
        localizedOldPriceString = internal.getDoubleDigit(article.localizedOldPriceString);
      }
      else if (typeof hm.campaign.api.locale.countryInfo.decimals !== 'undefined' && hm.campaign.api.locale.countryInfo.decimals === '0') {
        localizedPriceString = internal.removeDecimals(article.localizedPriceString);
        localizedOldPriceString = internal.removeDecimals(article.localizedOldPriceString);
      }

      if (typeof hm.campaign.api.locale.countryInfo.delimeter !== 'undefined') {
        localizedPriceString = localizedPriceString.replace('.', hm.campaign.api.locale.countryInfo.delimeter);
        localizedOldPriceString = localizedOldPriceString.replace('.', hm.campaign.api.locale.countryInfo.delimeter);
      }

      // format fix for korea, japan and russia
      // japan and korea shall have a comma sign as a thousand separator
      // russia shall have a space as a thousand separator
      if (hm.campaign.api.locale.country.toLowerCase() === 'jp' || hm.campaign.api.locale.locale.toLowerCase() === 'ko_kr') {
        localizedPriceString = internal.formatForSpecialConditions(localizedPriceString);
        localizedOldPriceString = internal.formatForSpecialConditions(localizedOldPriceString);
      }
      else if (hm.campaign.api.locale.country.toLowerCase() === 'ru') {
        localizedPriceString = internal.formatRussianPrice(localizedPriceString);
        localizedOldPriceString = internal.formatRussianPrice(localizedOldPriceString);
      }
      // format fix for china
      if (hm.campaign.api.locale.country.toLowerCase() === 'cn') {
        if (localizedPriceString.length > 7) {
          localizedPriceString = localizedPriceString.substring(0, 2) + ',' + localizedPriceString.substring(2, localizedPriceString.length);
        }
        if (localizedOldPriceString.length > 7) {
          localizedOldPriceString = localizedOldPriceString.substring(0, 2) + ',' + localizedOldPriceString.substring(2, localizedOldPriceString.length);
        }
      }

      // check if old price and if so show new price otherwise just normal price
      if (article.localizedOldPriceString !== '') {
        /** New Price */
        priceText = internal.baseObject('span', 'hm-price-new', localizedPriceString + ' ')
          .css('text-align', alignment);

        priceOldText = internal.baseObject('span', 'hm-price-old', '(' + localizedOldPriceString + ') ');

        priceRow.append(priceText);
        priceRow.append(priceOldText);
      }
      else {
        /** Normal Price */
        priceText = internal.baseObject('span', 'hm-price', localizedPriceString + ' ')
          .css('text-align', alignment)
          .css('color', color);


        priceRow.append(priceText);
      }

      // if horizontal but not prePriceInfo
      if (textLayout === "horizontal") {
        priceRow.css('display', 'inline-block');
        priceRow.css('margin-top', '1px');
      }

      /** More info */
      moreinfoRow = $('<p/>').addClass('hm-more-info');

      // append free text if any
      if (internal.findOptionInArray('freetext', hideoptions) && freeText !== "" && !(internal.element.hasClass('price-only'))) {
        moreinfoRow.append(internal.createText(freeText, 'hm-freetext')
          .css('color', color));
      }

      // size row
      if (internal.findOptionInArray('size', hideoptions) && hm.campaign_data.showSizeSpan && article.localizedSizeRange !== '' && !(internal.element.hasClass('price-only'))) {
        moreinfoRow.append(internal.baseObject('span', 'hm-size', article.localizedSizeRange)
          .css('color', color));
      }

      // designer row
      if (hm.campaign_data.showDesignerInfo && article.designer !== '' && !(internal.element.hasClass('price-only'))) {
        moreinfoRow.append(internal.createText(article.designer, 'hm-designer')
          .css('color', color));
      }

      // if sold out/coming soon
      if (hm.campaign_data.showAvailability) {
        if (article.availability === 'SOLD_OUT') {
          moreinfoRow.append(internal.createText(hm.campaign.staticTexts.articleStatus.soldOut, 'hm-sold-out')
            .css('color', color));
        } else if (article.availability === 'COMING_SOON') {
          moreinfoRow.append(internal.createText(hm.campaign.staticTexts.articleStatus.comingSoon, 'hm-sold-out')
            .css('color', color));
        }
      }

      // Create the HTML elements and populate them with article data
      var priceWidget = $("<div/>")
        .append(articleName)
        .append(priceRow)
        .append(moreinfoRow)
        .addClass('hm-priceWidget')
        .addClass('type-normal')
        .addClass('layout-' + textLayout)
        .css('text-align', alignment);

      // check which version of the widget we need (small, medium, large)
      if (internal.element.hasClass('small')) priceWidget.addClass('small');
      if (internal.element.hasClass('medium')) priceWidget.addClass('medium');
      if (internal.element.hasClass('large')) priceWidget.addClass('large');
      if (internal.element.hasClass('price-only')) priceWidget.addClass('price-only');

      // add a holder
      var wrapper = $('<div/>')
        .css('display', 'inline-block')
        .attr('id', internal.element.attr('id'))
        .append(priceWidget);

      internal.element = internal.element.replaceWith(wrapper);

      $(priceWidget)
        .on('click', function (event) {
          if (!hm.campaign.isDevice(hm.campaign.DEVICE_MOBILE)) {
            event.preventDefault();
            hm.campaign.widget.quicklookWidget.openProductView(article.productCode, article.articleCode);
          }
        });

      return priceWidget;
    };

    /**
     * Converts a one decimal string value to a two decimal string value.
     * @example internal.getDoubleDigit("¥32.0"); // returns "¥32.00"
     * @private
     * @param value price string
     */
    internal.getDoubleDigit = function (value) {
      if (value !== '') {
        // if the second to last string character is a dot - assume that this is a one decimal price and - add a second decimal
        if (value[value.length - 2] === '.') {
          value += '0';
        }
      }

      return value;
    };
    /**
     * Converts a one decimal string value to a zero decimal string value.
     * @example internal.getDoubleDigit("1290.0 Ft"); // returns "1290 Ft"
     * @private
     * @param value price string
     */
    internal.removeDecimals = function (value) {
      if (value !== '') {
        value = value.replace(/[.]\d*/, "");
      }
      return value;
    };
    /**
     * Formats prices that have special conditions, i.e. Japan and Korea
     * @example internal.formatForSpecialConditions("¥3499"); // returns "¥3,499"
     * @private
     * @param value price string
     */
    internal.formatForSpecialConditions = function (value) {
      if (value.length > 4 && value.indexOf(',') === -1) {
        value = internal.getThousandFormat(value, ',');
      }
      return value;
    }

    /**
     * Adds a space separator at the thousand mark (should be used for russian price formatting)
     * @private
     */
    internal.formatRussianPrice = function (value) {
      value = value.replace(' Руб', '');
      if (value.length > 3 && value.indexOf(' ') === -1) {
        value = internal.getThousandFormat(value, ' ');
      }
      value += ' Руб';
      return value;
    }

    internal.getThousandFormat = function (value, delimeter) {
      return value.substring(0, (value.length - 3)) + delimeter + value.substring((value.length - 3), value.length);
    }

    /**
     * Destroys the PriceWidget
     *
     * @memberOf hm.campaign.Widget.PriceWidget
     * @name destroy
     * @function
     */
    external.destroy = function destroy() {
      $('#' + internal.element.attr('id'))
        .remove('');
    };

    /**
     * @private

     */
    internal.baseObject = function (type, className, html, clickCallback) {
      var object = $("<" + type + "/>");

      if (typeof html === 'string')
        object.html(html);

      if (typeof className === 'string')
        object.addClass(className);

      if (typeof clickCallback === 'function')
        object.click(clickCallback);

      return object;
    };

    /**
     * @private

     */
    internal.createText = function (text, className, clickCallback) {
      return internal.baseObject(
        'span',
        className,
        text,
        clickCallback
      );
    };

    /**
     * @private
     */
    internal.findOptionInArray = function (value, array) {
      return ($.inArray(value, array) > -1) ? false : true;
    };

    /**
     * @private
     */
    internal.validateArray = function (hideoptions) {
      if (typeof hideoptions !== 'undefined' && hideoptions.length > 0) {
        for (var value in hideoptions) {
          if (internal.findOptionInArray(hideoptions[value], internal.availableOptions)) {
            hm.campaign.debug.warn('Price Widget: ' + hideoptions[value] + ' is not a valid option');
          }
        }
      }
    };

    internal.init();

    return external;
  };
})(this, jQuery);

/**
 *  @author    Johannes Axner <johannes.axner@hm.com>
 *  @author    Linda Wagnerius <linda.wagnerius@hm.com>
 *  @author    Simon Nkangi <simon.nkangi@hm.com>
 *  @copyright Copyright (c) 2015 H&M
 *  @since     Version 2.0
 */
(function (exports, $) {
  'use strict';
  /**
   * Quick Look/Quick Buy button widget.
   *
   * @memberOf hm.campaign.Widget
   * @name QuicklookWidget
   * @class
   * @returns {QuicklookWidget} An instance of hm.campaign.Widget.QuicklookWidget.
   */
  exports.QuicklookWidget = function () {
    /************************************ Public variables ************************************/
    /**
     * @private
     */
    var internal = {};
    /**
     * @private
     */
    var external = {};

    internal.counter = 1;
    internal.locked = false;
    internal.clickTimeout = 242;
    internal.timer = 0;
    internal.baseUrlGOEP = "/[locale]/productpage/_jcr_content/product.quickbuy.[article].html";

    /************************************ Private variables ************************************/

    /************************************ Constants variables ************************************/

    /************************************ Public methods ************************************/

    /**
     * <br/>
     * Iterates through each element in the DOM that has both the class "campaign-widget" and the class "campaign-quicklook".
     * Each of these DOM elements will be replaced with a Quicklook Widget.
     *
     * @memberOf hm.campaign.Widget.QuicklookWidget
     * @name run
     * @function
     * @example <caption>Parses markup as the following into a QuickLook widget</caption>
     * <div class="campaign-widget campaign-quicklook" data-alias="article-11"></div>
     */
    external.run = function () {
      $('.campaign-widget.campaign-quicklook:not(.campaign-widget-processed)')
        .each(function () {
          var $this = $(this);
          if ($(this)
              .attr('class')
              .indexOf("") != -1) {
            var $element = $(this),
              alias = $element.data('alias');
            if (hm.campaign.api.article.isArticleAvailable(alias)) {
              if (hm.campaign.isTouch()) {
                if (hm.campaign.getEnvironment() === hm.campaign.ENVIRONMENT_GOEP) {
                  internal.createTouchQuicklookGOEP($element, alias);
                }
                else {
                  internal.createTouchQuicklook($element, alias);
                }
              }
              else if (hm.campaign.getEnvironment() === hm.campaign.ENVIRONMENT_GOEP) {
                internal.createQUicklookGOEP($element, alias);
              }
              else {
                internal.createQuicklook($element, alias);
              }
            }
          }
        });
      return external;
    };

    /**
     * Creates and returns a quicklookWidget as a jQuery object.
     *
     * @param {Object} holder       The holder element
     * @param {String} id           The created widget id
     * @param {String} alias        The alias of the product which the price widget is associated with
     *
     * @memberOf hm.campaign.Widget.QuicklookWidget
     * @name create
     * @function
     * @example <caption>Creates the html snippet</caption>
     * <button class="btn ql quicklook" id="p1-N1001E" data-article="12278-G" data-product="12278" data-campaign="Q77_Ladies_Summer_New_Arrivals" data-shoporigin="CA" style="opacity: 0;">
     *  <span>
     *      <span>Shop Now</span>
     *  </span>
     * </button>

     */
    external.create = function ($holder, id, alias) {
      if (hm.campaign.api.article.isArticleAvailable(alias)) {
        var element = $('<div class="campaign-widget campaign-quicklook"/>');
        element.attr('id', id);
        $holder.append(element);

        if (hm.campaign.isTouch()) {
          if (hm.campaign.getEnvironment() === hm.campaign.ENVIRONMENT_GOEP) {
            return internal.createTouchQuicklookGOEP(element, alias);
          }
          else {
            return internal.createTouchQuicklook(element, alias);

          }
        }
        else if (hm.campaign.getEnvironment() === hm.campaign.ENVIRONMENT_GOEP) {
          return internal.createQUicklookGOEP(element, alias);
        }

        else {
          return internal.createQuicklook(element, alias);
        }
      }
    };

    /**
     * Destroys the QuicklookWidget
     *
     * @memberOf hm.campaign.Widget.QuicklookWidget
     * @name destroy
     * @function
     */
    external.destroy = function destroy() {
      $('.campaign-widget.campaign-quicklook')
        .html('');
    };

    /**
     * Opens the "quicklook" product view popup based on incoming product id and product article id
     *
     * @param {String} product          Product ID
     * @param {String} article          Product article ID
     * @param {String} [variant]        Product article variant ID
     * @param {String} [look]           Look ID
     * @param {String} [lookImageUrl]   URL to look image
     * @param {String} [shopOrigin]     Origin of shopping (metrics)
     *
     * @memberOf hm.campaign.Widget.QuicklookWidget
     * @name openProductView
     * @function
     */
    external.openProductView = function openProductView(product, article, variant, look, lookImageUrl, shopOrigin) {
      if (hm.campaign.isDevice(hm.campaign.DEVICE_MOBILE)) {
        var data = hm.campaign.api.article.getArticle(article);
        location.href = data.url;
      }
      else if (hm.campaign.getEnvironment() === hm.campaign.ENVIRONMENT_GOEP) {
        internal.openQuickBuyGOEP(internal.createQuicklookUrlGOEP({
          'article': article
        }));
      }
      else {
        hm.quicklook.show({
          product: product,
          article: article,
          variant: variant || '',
          look: look || '',
          lookImageUrl: lookImageUrl || '',
          shopOrigin: shopOrigin || '',
          campaign: hm.campaign_data.campaignId
        });
      }
    };
    internal.openQuickBuyGOEP = function openQuickBuytGOEP(url) {
      if (!internal.locked) {
        internal.locked = true;
        hm.quickBuy.showQuickBuy(url);
        internal.timer = setTimeout(function () {
          internal.locked = false;
        }, internal.clickTimeout);
      }
    };

    /**
     * Opens the "quicklook" product view popup based on incoming article alias
     *
     * @param {String} alias      Article Alias ex. article-10
     *
     * @memberOf hm.campaign.Widget.QuicklookWidget
     * @name openProductViewByAlias
     * @function
     */
    external.openProductViewByAlias = function openProductViewByAlias(alias) {
      if (hm.campaign.api.article.isArticleAvailable(alias)) {
        if (hm.campaign.getEnvironment() === hm.campaign.ENVIRONMENT_GOEP) {
          internal.openQuickBuyGOEP(internal.createQuicklookUrlGOEP({
            'alias': alias
          }));
        }
        else {
          var article = hm.campaign.api.article.getArticleByAlias(alias);
          hm.quicklook.show({
            product: article.productCode,
            article: article.articleCode,
            variant: '',
            look: '',
            lookImageUrl: '',
            shopOrigin: '',
            campaign: hm.campaign_data.campaignId
          });
        }
      }
    };

    /************************************ Private methods ************************************/
    /**
     * @private
     */
    internal.init = function () {
      // Texts will be replaced at hm.campaign.api.texts.data.greeting

    };

    /**
     * Create the html snippet
     * @private
     *@param String alias - The article alias
     */
    internal.createQuicklook = function createQuicklook($element, alias) {
      // Fetch the specific article. The articles are assumed to be preloaded
      var article = hm.campaign.api.article.getArticleByAlias(alias);
      var textSpan = $("<span/>");

      var btnText = hm.campaign.api.article.isShopNow(alias) ? internal.getQuickShopLabel() : internal.getQuickLookLabel();
      textSpan.html(btnText);

      var spanContainer = $("<span/>");
      spanContainer.append(textSpan);

      var button = $("<button/>");
      button.addClass("btn quicklook ng-isolate-scope");
      if (!hm.campaign.api.article.isShopNow(alias)) {
        button.addClass('non-transactional');
      }
      button.attr('data-article', article.articleCode);
      button.attr('data-product', article.productCode);
      button.attr('data-campaign', hm.campaign_data.campaignId);
      button.append(spanContainer);

      $element.addClass('campaign-widget-processed');
      $element.html(button);

      return external;
    };

    internal.createTouchQuicklookGOEP = function createTouchQuicklookGOEP($element, alias) {
      return internal.createTouchQuicklook($element, alias);
    };

    /**
     * Create the html snippet for touch devices
     * @private
     * @param String alias - The article alias
     */
    internal.createTouchQuicklook = function createTouchQuicklook($element, alias) {
      // Fetch the specific article. The articles are assumed to be preloaded
      var article = hm.campaign.api.article.getArticleByAlias(alias);

      var divContainer = $("<div/>");
      divContainer.addClass('touch-shownow');
      divContainer.data('article', article.articleCode);
      divContainer.data('product', article.productCode);
      divContainer.data('campaign', hm.campaign_data.campaignId);
      divContainer.on('click', function () {
        external.openProductViewByAlias(alias);
      });
      divContainer.append($("<span/>"));

      $element.addClass('campaign-widget-processed');
      $element.html(divContainer);

      // return divContainer;
      return external;
    };


    external.createQuicklookUrl = internal.createQuicklookUrl = function createQuicklookUrl(alias) {
      if (hm.campaign.isEnvironment(hm.campaign.ENVIRONMENT_GOEP)) {
        return internal.createQuicklookUrlGOEP({alias:alias});
      }
      else {
        var article = hm.campaign.api.article.getArticleByAlias(alias);
        var url = '{urlPrefix}/product/{productCode}?article={articleCode}'
          .replace('{urlPrefix}', hm.campaign.api.locale.localizationUrlPrefix)
          .replace('{productCode}', article.productCode)
          .replace('{articleCode}', article.articleCode);

        return url;
      }

    };

    internal.createQuicklookUrlGOEP = function createQuicklookUrlGOEP(data) {
      var article = data.article,
        url = internal.baseUrlGOEP.replace('[locale]', hm.campaign.utils.getUrlPrefix());
      if (data.alias) {
        article = hm.campaign_data.articles[data.alias];
      }
      url = url.replace('[article]', article);
      // if (hm.campaign.isLocal()) {
      //   url = document.location.href.split(hm.campaign.utils.getUrlPrefix())[0] + 'environment/goep/quick_buy.html';
      // }
      return url;
    };

    internal.createQUicklookGOEP = function createQUicklookGOEP($element, alias) {
      if ($element.hasClass('campaign-widget-processed')) {
        return false;
      }
      else {
        var url = internal.createQuicklookUrlGOEP({
            alias: alias
          }),
          $button = $('<a class="button button-quick-buy quick-buy-trigger"/>'),
          btnText = internal.getQuickShopLabel();
        $button.prop('href', url);
        $button.prop('id', 'quicklook' + internal.counter);
        $button.data('quick-buy-url', url);
        $button.data('alias', alias);
        $button.text(btnText);

        internal.counter += 1;

        $element.addClass('campaign-widget-processed');
        $element.append($button);

        // center the quicklook button
        var buttonLeft = -Math.floor($button.outerWidth() / 2);
        var buttonTop = -Math.floor($button.outerHeight() / 2);
        $button
          .css('left', buttonLeft)
          .css('top', buttonTop);

        $button.on('click', function (e) {
          e.preventDefault();
          var $this = $(this);
          internal.openQuickBuyGOEP($this.data('quick-buy-url'));
          if ($this.parent()
              .data('visibility') && $this.parent()
              .data('visibility') === 'hover') {
            $this.parent()
              .hide();
          }
          return false;
        });

        return external;
      }
    };

    internal.getQuickShopLabel = function getQuickShopLabel() {
      return hm.campaign.api.locale.shopNowLabel.length ? hm.campaign.api.locale.shopNowLabel : "Shop Now";
    };

    internal.getQuickLookLabel = function getQuickLookLabel() {
      return hm.campaign.api.locale.shopNowLabel.length ? hm.campaign.api.locale.shopNowLabel : "Quick Look";
    };

    internal.init();

    return external;
  };
})(this, jQuery);

/**
 *  H&M Campaign API
 *
 *  Adds connectivity with H&M Backend services
 *
 *  @author    Johannes Axner <johannes.axner@hm.com>
 *  @author    Linda Wagnerius <linda.wagnerius@hm.com>
 *  @author    Simon Nkangi <simon.nkangi@hm.com>
 *  @copyright Copyright (c) 2015 H&M
 *  @since     Version 2.0
 *
 *  COPYRIGHT TEXT
 *  SOFTWARE TEXT
 */
(function (context, $) {
    'use strict';
    /**
     * The API object to retrieve the available backend services
     *
     * @name hm.campaign.API
     * @class
     * @param Object settings - Settings for campaign.
     * @returns {CampaignAPI} An instance of hm.campaign.API.
     */
    context.CampaignAPI = function CampaignAPI(settings) {
        /************************************ external variables ************************************/

        /**
         * @private
         */
        var internal = {};
        var external = {};

        /************************************ internal variables ************************************/

        /************************************ Constants variables ************************************/


        // Setup all required services
        if (typeof CampaignCommons === 'function') {
            external.commons = new CampaignCommons(settings, external);
        }

        if (typeof CampaignLocale === 'function') {
            external.locale = new CampaignLocale(settings, external);
        }

        if (typeof CampaignArticle === 'function') {
            external.article = new CampaignArticle(settings, external);
        }

        if (typeof CampaignStoreLocator === 'function') {
            external.storelocator = new CampaignStoreLocator(settings);
        }

        if (typeof CampaignAPIStatistics === 'function') {
            external.statistics = new CampaignAPIStatistics(settings, external);
        }

        if (typeof CampaignTexts === 'function') {
            external.texts = new CampaignTexts(settings, external);
        }

        return external;
    };
})(this, jQuery);

/**
 *  @author    Johannes Axner <johannes.axner@hm.com>
 *  @author    Linda Wagnerius <linda.wagnerius@hm.com>
 *  @author    Simon Nkangi <simon.nkangi@hm.com>
 *  @copyright Copyright (c) 2015 H&M
 *  @since     Version 2.0
 */

(function (exports, $) {
  'use strict';
  /**
   *
   * Article data API.
   *
   * @memberOf hm.campaign.API
   * @name Article
   * @class
   * @param Object settings - Settings for campaign.
   * @returns {CampaignArticle} An instance of hm.campaign.API.Article.
   */
  exports.CampaignArticle = function (settings) {
    /************************************ Public variables ************************************/
    /**
     * @private
     */
    var internal = {};
    /**
     * @private
     */
    var external = {};

    internal.articleMap = {};
    internal.aliases = [];
    internal.articles = [];
    internal.maxQueueLength = 10;
    internal.loadQueue = [];
    internal.queueTimeout = null;
    internal.cache = {
      'articles': {},
      'requests': []
    };
    internal.loading = false;
    internal.loadQueueSize = 0;
    internal.loadDoneSize = 0;
    internal.articleDataServiceIsAvailable = true;

    internal.init = function init() {
      var alias, article,
        environmentKey = hm.campaign.getEnvironment() === hm.campaign.ENVIRONMENT_GOEP ? 1 : 0;

      // Get articles from config
      internal.articleMap = hm.campaign_data.articles;

      // Populate data holders
      for (alias in internal.articleMap) {
        article = alias[environmentKey];
        if (article) {
          internal.aliases.push(alias);

          internal.articles.push(internal.articleMap[alias]);
        }
      }
    };

    internal.processQueueGOEP = function processQueueGOEP() {
      var i, url,
        articleUrlBase = hm.campaign.config.data('productUrlGoep') + 'hmwebservices/service/article/get-article-by-code/[articleCountry]/Online/'.replace('[articleCountry]', hm.campaign.api.locale.articleCountry),
        alias = internal.loadQueue.pop(),
        articleId = hm.campaign.api.article.getArticleIdByAlias(alias);

      clearTimeout(internal.queueTimeout);

      if (!articleId) {
        // No article found for id!
        internal.loadDoneSize++;
        internal.processGoepArticleDone();
        return;
      }
      url = articleUrlBase + articleId;

      if (hm.campaign.api.locale.articleLanguage.length) {
        url = url + '/' + hm.campaign.api.locale.articleLanguage;
      }

      if (internal.checkRequestCache(url)) {
        return false;
      }

      $.ajax({
        url: url,
        dataType: 'json',
        contentType: 'application/json'
      })
        .always(function () {
          internal.loadDoneSize++;
          internal.cache.requests.push(url);
        })
        .done(function (data) {
          internal.processGoepArticle(alias, data);
          internal.processGoepArticleDone();
        })
        .fail(function (jqXHR, textStatus, errorThrown) {
          // hm.campaign.debug.warn('processQueueGOEP', 'Article data not loaded', alias, articleId);
          internal.processGoepArticleDone();
        });
    };

    internal.processGoepArticle = function processArticle(alias, data) {
      var $data = $(data),
        availability = data.product.inStock ? 'IN_STOCK' : 'SOLD_OUT',
        article = {
          "alias": alias,
          "articleCode": data.product.code,
          "availability": availability,
          "designer": "",
          "localizedAvailabilityString": "",
          "localizedName": data.product.name,
          "localizedOldPriceString": "",
          "localizedPriceString": "",
          "localizedSizeRange": "",
          "prePriceInfo": "",
          "productCode": data.product.ancestorProductCode,
          "url": hm.campaign.api.locale.localizationUrlPrefix + "/productpage." + data.product.code + ".html"
        };

      var currentLocale = hm.campaign.api.locale.locale.toLowerCase();
      external.countryInfo = external.countryInfo || {};
      external.countryInfo.currency = hm.campaign.countryInfo[currentLocale].currency;
      external.countryInfo.decimals = hm.campaign.countryInfo[currentLocale].decimals;

      var whitePrice;
      var redPrice;

      if (typeof data.product.redPrice !== 'undefined') {
        if (external.countryInfo.decimals !== undefined) {
          whitePrice = data.product.whitePrice.price;
          if (whitePrice) {
            whitePrice = parseFloat(whitePrice)
              .toFixed(external.countryInfo.decimals);
          }
          else {
            whitePrice = '';
          }

          redPrice = data.product.redPrice.price;
          if (redPrice) {
            redPrice = parseFloat(redPrice)
              .toFixed(external.countryInfo.decimals);
          }
          else {
            redPrice = '';
          }
        }

        else {
          whitePrice = data.product.whitePrice.price;
          whitePrice = whitePrice ? whitePrice : '';
          redPrice = data.product.redPrice.price;
          redPrice = redPrice ? redPrice : '';

        }

        article.localizedOldPriceString = external.countryInfo.currency.replace('[price]', whitePrice);
        article.localizedPriceString = external.countryInfo.currency.replace('[price]', redPrice);
      }

      else {
        if (external.countryInfo.decimals !== undefined) {
          whitePrice = whitePrice = parseFloat(data.product.whitePrice.price)
            .toFixed(external.countryInfo.decimals);
        }

        else {
          whitePrice = data.product.whitePrice.price;
        }

        article.localizedPriceString = external.countryInfo.currency.replace('[price]', whitePrice);
      }

      if (data.product.inStock) {
        internal.cache.articles[alias] = article;
      }

      // send event about item being done
      hm.campaign.dispatchEvent(hm.campaign.ARTICLES_PROGRESS, internal.cache.articles);
      // @TODO: Add listener for each product loaded
      // hm.campaign.dispatchEvent(hm.campaign.ARTICLES_PROGRESS, article);
    };

    internal.processGoepArticleDone = function processGoepArticleDone() {
      // Check if there are more items and load them
      if (internal.loadDoneSize < internal.loadQueueSize && internal.loadDoneSize % internal.maxQueueLength === 0) {
        internal.processQueueStepGOEP();
      }
      else if (internal.loading === true && internal.loadDoneSize === internal.loadQueueSize) {
        // Everything is loaded
        internal.loading = false;
        internal.queueComplete(internal.cache.articles);
      }
    };

    internal.queueComplete = function queueComplete(articles) {
      hm.campaign.dispatchEvent(hm.campaign.ARTICLES_RETRIEVED, articles);
    };


    internal.loadedArticles = function loadedArticles() {
      var a,
        articles = {
          'length': 0
        };
      for (a in internal.cache.articles) {
        if (internal.cache.articles.hasOwnProperty(a)) {
          articles[a] = internal.cache.articles;
          articles.length += 1;
        }
      }
      return articles;
    };

    internal.loadArticles = function loadArticles(aliases) {
      var a,
        aliasesToLoad = [],
        status = {
          'status': '',
          'input': aliases,
          'requested': [],
          'loader': null
        };
      for (a in aliases) {
        if (aliases.hasOwnProperty(a)) {
          if (typeof aliases[a] !== 'undefined' && aliases[a].match(/^article-[0-9]+$/) && !external.getArticleByAlias(aliases[a])) {
            status.requested.push(aliases[a]);
          }
        }
      }

      if (hm.campaign.getEnvironment() === hm.campaign.ENVIRONMENT_GOEP) {
        status.loader = internal.loadArticlesGoep(status.requested);
      }
      else {
        status.loader = internal.loadArticlesJoshua(status.requested);
      }

      if (aliases.length === status.requested.length) {
        status.status = 'All articles requested.';
      }
      else if (status.requested.length) {
        status.status = 'Partial articles requested.';

      }
      else {
        status.status = 'No articles requested.';
      }
      return status;
    };
    internal.loadArticlesGoep = function loadArticlesGoep(aliases) {
      var alias, i;

      for (alias = 0; alias < aliases.length; alias += 1) {
        if (!hm.campaign.api.article.isArticleAvailable(aliases[alias]) && $.inArray(aliases[alias], internal.loadQueue)) {
          internal.loadQueue.push(aliases[alias]);
        }
      }

      clearTimeout(internal.queueTimeout);

      internal.loading = true;
      internal.loadQueueSize += aliases.length;
      internal.queueTimeout = setTimeout(internal.processQueueStepGOEP, 100);

      return true;
    };

    internal.loadArticlesJoshua = function loadArticlesJoshua(aliases) {
      var i,
        alias,
        baseurl = hm.campaign.config.data('productUrlFetch') + 'v2/{COUNTRY}/{LANGUAGE}/products/fetchDA?productNumbers=',
        url,
        articles = [],
        products = [],
        headers = {},
        date = new Date(),
        startDate;

      baseurl = baseurl.replace('{COUNTRY}', hm.campaign.api.locale.country.toLowerCase());
      baseurl = baseurl.replace('{LANGUAGE}', hm.campaign.api.locale.language.toLowerCase());

      if (window.location.href.search(/\/(www|www2|tablet|m|m2)\.hm\.com\//) < 0) {
        baseurl = baseurl.replace('/api.hm.com/', '/admin-api.hm.com/');

        if (hm.campaign_data.hasOwnProperty('startDate') && hm.campaign_data.startDate) {
          headers['hm-previewtimestamp'] = hm.campaign_data.startDate;
        }
      }

      if (typeof aliases === 'undefined' || !aliases.length) {
        aliases = [];
        for (alias in hm.campaign_data.articles) {
          aliases.push(alias);
        }
      }

      for (alias in aliases) {
        articles.push(hm.campaign_data.articles[aliases[alias]]);

      }

      url = baseurl + articles.join('%2C');

      if (typeof hm.campaign_data.showAvailability !== 'undefined' && !hm.campaign_data.showAvailability) {
        url = url + "&concealSoldOut=true";
      }

      if (internal.checkRequestCache(url)) {
        return false;
      }

      return $.ajax({
        dataType: "json",
        url: url,
        headers: headers
      })
        .done(internal.loadArticlesJoshuaDone)
        .fail(internal.loadArticlesJoshuaFail)
        .always(function () {
          internal.cache.requests.push(url);
        });
    };
    internal.checkRequestCache = function checkRequestCache(url) {
      var i;
      for (i in internal.cache.requests) {
        if (url === internal.cache.requests[i]) {
          return true;
        }
      }
      return false;
    };
    internal.loadArticlesJoshuaDone = function loadArticlesJoshuaDone(data) {
      var article_id,
        alias;

      $.each(data.displayArticles, function (index, article) {
        article_id = article['castorProductNumber'] + article['castorArticleNumber'];
        if ($.inArray(article_id, hm.campaign_data.articles)) {
          alias = $.map(hm.campaign_data.articles, function (value, index) {
            if (article_id == value) {
              return index;
            }
          });
          alias = alias.toString();
          internal.cache.articles[alias] = internal.createFetchArticle(article.alias, article);
        }
      });

      internal.queueComplete(internal.cache.articles);
    };
    internal.createFetchArticle = function createFetchArticle(alias, article) {
      var sale = false,
        oldPrice = '',
        price = '',
        sizes = '',
        availability = '',
        articleCode,
        productCode;
      if (typeof article.priceInfo !== 'undefined') {
        if (typeof article.priceInfo.formattedPrice !== 'undefined') {
          sale = typeof article.priceInfo.onSale !== 'undefined' ? article.priceInfo.onSale : false;
          oldPrice = typeof article.priceInfo.formattedOldPrice !== 'undefined' ? article.priceInfo.formattedOldPrice : '';
          price = typeof article.priceInfo.formattedPrice !== 'undefined' ? article.priceInfo.formattedPrice : '';
        }
      }
      if (typeof article.availableSizes !== 'undefined' && article.availableSizes.length > 1) {
        sizes = article.availableSizes[0] + "-" + article.availableSizes[article.availableSizes.length - 1];
      }
      if (typeof article.stockState !== 'undefined' && typeof article.assortmentState !== 'undefined') {
        if (article.stockState === 'IN_STOCK' && article.assortmentState === 'CURRENT') {
          availability = 'IN_STOCK';
        }
        else if (article.assortmentState === 'COMING_SOON') {
          availability = 'COMING_SOON';
        }
        else if (article.stockState === 'SOLD_OUT') {
          availability = 'SOLD_OUT';
        }
        else if (article.stockState === 'UNDETERMINED') {
          availability = 'UNDETERMINED';
        }
      }
      articleCode = typeof article.articleCode !== 'undefined' ? article.articleCode : '';
      productCode = typeof article.productNumber !== 'undefined' ? article.productNumber : '';
      return {
        "alias": alias,
        "articleCode": articleCode,
        "availability": availability,
        "designer": "",
        "localizedAvailabilityString": "",
        "localizedName": typeof article.name !== 'undefined' ? article.name : '',
        "localizedOldPriceString": sale && oldPrice.length ? oldPrice : "",
        "localizedPriceString": price,
        "localizedSizeRange": sizes,
        "prePriceInfo": "",
        "productCode": productCode,
        "url": hm.campaign.api.locale.localizationUrlPrefix + '/product/' + productCode + '?article=' + articleCode
      };
    };
    internal.loadArticlesJoshuaFail = function loadArticlesJoshuaError(status, message) {
      if (window.location.hostname !== 'www.hm.com' && window.location.hostname !== 'tablet.hm.com') {
        internal.articleDataServiceIsAvailable = false;
        hm.campaign.dispatchEvent(hm.campaign.ARTICLES_RETRIEVED, null);
      }
      // Create some proper error handling here
      hm.campaign.debug.log(message);
    };

    internal.processQueueStepGOEP = function processQueueStepGOEP() {
      var i,
        length = internal.maxQueueLength < internal.loadQueue.length ? internal.maxQueueLength : internal.loadQueue.length,
        delay;
      for (i = 0; i < length; i++) {
        if (!hm.campaign_data.is_local) {
          internal.processQueueGOEP();
        }
        else {
          // this delay prevents ajax errors when retrieving articles from goep sdk mock
          delay = i * 10 + 100;
          setTimeout(internal.processQueueGOEP, delay);
        }
      }
    };

    internal.getArticleIdByAlias = function getArticleIdByAlias(alias) {
      if (!alias || (alias && !alias.length)) {
        hm.campaign.debug.warn('getArticleIdByAlias', 'No alias provided');
        return false;
      }
      if (typeof hm.campaign_data.articles[alias] !== 'undefined') {
        return hm.campaign_data.articles[alias];
      }
      else {
        hm.campaign.debug.warn('getArticleIdByAlias', 'No article ID found for alias', alias);
        return false;
      }
    };

    internal.getMockedErrorArticle = function getMockedErrorArticle(alias) {
      return {
        "alias": alias,
        "localizedName": "Product not available for test",
        "localizedOldPriceString": "",
        "localizedPriceString": "$XX.XX"
      };
    };

    internal.getArticleByAlias = function getArticleByAlias(alias) {
      if (internal.articleDataServiceIsAvailable) {
        if (typeof internal.cache.articles[alias] !== 'undefined' && internal.cache.articles[alias].availability !== 'UNDETERMINED') {
          return internal.cache.articles[alias];
        }

        return false;
      }
      else {
        return internal.getMockedErrorArticle(alias);
      }
    };

    /************************************ Public methods ************************************/

    /**
     * Load articles from backend to the framework. All articles must be loaded or attempted to be loaded before using their aliases. Dispatches the hm.campaign.ARTICLES_RETRIEVED event when done.
     *
     * @memberOf hm.campaign.API.Article
     * @name loadArticles
     * @function
     *
     * @param {Array} [aliases] - An array of aliases to load from backend. If no list is provided all articles from the campaign data will be loaded.
     * @return {mixed} boolean or jQuery AJAX object depending on what the service returns.
     */
    external.loadArticles = function (aliases) {
      aliases = aliases || internal.aliases;
      return internal.loadArticles(aliases);
    };

    /**
     * Use this method to check if an article is available.
     *
     * @memberOf hm.campaign.API.Article
     * @name isArticleAvailable
     * @function
     *
     * @param {String} alias - The alias of the article to look up.
     * @return {Boolean} true if the article is loaded, false if the article is not loaded (after attempts).
     */
    external.isArticleAvailable = function (alias) {
      return internal.getArticleByAlias(alias) ? true : false;
    };

    /**
     * Checks if the article is available in the online store
     *
     * @memberOf hm.campaign.API.Article
     * @name isShopNow
     * @function
     *
     * @param {String} alias - The alias of the article to look up
     * @return {Boolean} true if the article is available in online store, false othervise.
     */
    external.isShopNow = function (alias) {
      return (hm.campaign.api.locale.transactional && internal.getArticleByAlias(alias)
        .availability === 'IN_STOCK');
    };

    /**
     * Get an article by alias.
     *
     * @memberOf hm.campaign.API.Article
     * @name getArticleByAlias
     * @function
     *
     * @param {String} alias - The alias of the article.
     * @return {Article} The found article.
     */
    external.getArticleByAlias = function getArticleByAlias(alias) {
      return internal.getArticleByAlias(alias);
    };

    /**
     * Get an article id by its alias.
     *
     * @memberOf hm.campaign.API.Article
     * @name getArticleIdByAlias
     * @function
     *
     * @param {String} alias - The alias of the article.
     * @return {String} The found article's id.
     */
    external.getArticleIdByAlias = function getArticleIdByAlias(alias) {
      return internal.getArticleIdByAlias(alias);
    };

    /**
     * Get an article by its article id.
     *
     * @memberOf hm.campaign.API.Article
     * @name getArticle
     * @function
     *
     * @param {String} articleId - The id code of the article.
     * @return {Article} The found article.
     */
    external.getArticle = function getArticle(articleId) {
      return internal.getArticle(articleId);
    };

    /**
     * Returns a list of article aliases for the campaign.
     *
     * @memberOf hm.campaign.API.Article
     * @name getAliases
     * @function
     *
     * @return {Array} A list of article aliases.
     */
    external.getAliases = function getAliases() {
      return internal.aliases.slice(0);
    };

    internal.init();
    return external;
  };

})(this, jQuery);
/**
 *  @author    Johannes Axner <johannes.axner@hm.com>
 *  @author    Linda Wagnerius <linda.wagnerius@hm.com>
 *  @author    Simon Nkangi <simon.nkangi@hm.com>
 *  @copyright Copyright (c) 2015 H&M
 *  @since     Version 2.0
 */
(function (context, $) {
    'use strict';
    /**
     *
     * Locale information API.
     *
     * @memberOf hm.campaign.API
     * @name Locale
     * @class
     * @param Object settings - Settings for campaign.
     * @returns {CampaignLocale} An instance of hm.campaign.API.Locale.
     */
    context.CampaignLocale = function CampaignLocale(settings) {
        /************************************ Public variables ************************************/
        /**
         * @memberOf hm.campaign.API.Locale
         * @private
         */
        var internal = {};
        /**
         * @memberOf hm.campaign.API.Locale
         * @private
         */
        var external = {};

        /**
         * The country code.
         * @memberOf hm.campaign.API.Locale
         * @name country
         * @type {String}
         */
        external.country = '';

        /**
         * Shortcode for language files
         * @memberOf hm.campaign.API.Locale
         * @name copyUrl
         * @type {String}
         */
        external.copyUrl = '';

        /**
         * Shortcode for fallback language files
         * @memberOf hm.campaign.API.Locale
         * @name copyFallbackUrl
         * @type {String}
         */
        external.copyFallbackUrl = '';

        /**
         * If the current locale has image restriction.
         * @memberOf hm.campaign.API.Locale
         * @name imageRestriction
         * @type {Boolean}
         */
        external.imageRestriction = '';

        /**
         * The language code.
         * @memberOf hm.campaign.API.Locale
         * @name language
         * @type {String}
         */
        external.language = '';

        /**
         * The locale code.
         * @memberOf hm.campaign.API.Locale
         * @name locale
         * @type {String}
         */
        external.locale = '';

        /**
         * The localization url prefix.
         * @memberOf hm.campaign.API.Locale
         * @name localizationUrlPrefix
         * @type {String}
         */
        external.localizationUrlPrefix = '';

        /**
         * If the current locale is a transactional country.
         * @memberOf hm.campaign.API.Locale
         * @name transactional
         * @type {Boolean}
         */
        external.transactional = false;

        /**
         * Coutnry code for GOEP article fetching for current locale.
         * @memberOf hm.campaign.API.Locale
         * @name articleCountry
         * @type {String}
         */
        external.articleCountry = '';

        /**
         * Language code for GOEP article fetching for current locale.
         * @memberOf hm.campaign.API.Locale
         * @name articleLanguage
         * @type {String}
         */
        external.articleLanguage = '';

        /**
         * Label to display on Shop Now buttons for current locale.
         * @memberOf hm.campaign.API.Locale
         * @name shopNowLabel
         * @type {String}
         */
        external.shopNowLabel = '';

        /**
         * Currency string for current locale.
         * @memberOf hm.campaign.API.Locale
         * @name currency
         * @type {String}
         */
        external.currency = '';


        external.countryInfo = {};



        /* *********************************** external methods *********************************** */

        internal.init = function () {
            if (hm.campaign.getEnvironment() === hm.campaign.ENVIRONMENT_GOEP) {
                external.copyUrl = hm.campaign.utils.getUrlPrefix();
            }
            else {
                external.copyUrl = hm.campaign.utils.getUrlPrefix();
            }

            hm.campaign.addEventListener(hm.campaign.COUNTRYINFO_RETRIEVED, internal.onCountryInfoRetrieved);
            internal.getLocaleInfo();
        };

        internal.onCountryInfoRetrieved = function (data) {
            var index;

            // wrap campaign div with a div with language as class
            if (data && data.hasOwnProperty('locale')) {
                $('#campaign')
                    .wrap('<div class="' + data.locale + '" />');
            }

            for (index in data) {
                if (data.hasOwnProperty(index) && typeof external[index] !== 'undefined') {
                    external[index] = data[index];
                }
            }
        };

        internal.getLocaleInfo = function getLocaleInfo() {

            var locale = hm.campaign.utils.getUrlPrefix()
                .replace('/', '')
                .replace('/', '_')
                .toLowerCase(),
                data = hm.campaign.countryInfo[locale],
                countryInfo;

            countryInfo = {
                'country': data.country,
                'imageRestriction': Boolean(data.imageRestriction),
                'language': data.language,
                'locale': data.locale,
                'localizationUrlPrefix': data.localizationUrlPrefix,
                'copyUrl': data.language,
                'copyFallbackUrl': data.language,
                'transactional': hm.campaign.getEnvironment() === hm.campaign.ENVIRONMENT_GOEP ? true : Boolean(data.isTransactional)
            };

            if (data.shopNowLabel && typeof data.shopNowLabel !== undefined && data.shopNowLabel.length > 0) {
                countryInfo.shopNowLabel = data.shopNowLabel;
            }

            if (data.articleCountry && typeof data.articleCountry !== undefined && data.articleCountry.length > 0) {
                countryInfo.articleCountry = data.articleCountry;
            }

            if (data.currency && typeof data.currency !== undefined && data.currency.length > 0) {
                countryInfo.currency = data.currency;
            }

            if (data.decimals && typeof data.decimals !== undefined && data.decimals.length > 0) {
                countryInfo.decimals = data.decimals;
            }

            if (data.articleLanguage && typeof data.articleLanguage !== undefined && data.articleLanguage.length > 0) {
                countryInfo.articleLanguage = data.articleLanguage;
            }

            if (data.delimeter && typeof data.delimeter !== undefined && data.delimeter.length > 0) {
                countryInfo.delimeter = data.delimeter;
            }

            external.countryInfo = countryInfo;
            hm.campaign.dispatchEvent(hm.campaign.COUNTRYINFO_RETRIEVED, countryInfo);
        };

        internal.init();

        return external;
    };
})(this, jQuery);

/**
 *  @author    Johannes Axner <johannes.axner@hm.com>
 *  @author    Linda Wagnerius <linda.wagnerius@hm.com>
 *  @author    Simon Nkangi <simon.nkangi@hm.com>
 *  @copyright Copyright (c) 2015 H&M
 *  @since     Version 2.0
 */

(function (context, $) {
    'use strict';
    /**
     *
     * Statistics tracking API.
     *
     * @memberOf hm.campaign.API
     * @name Statistics
     * @class
     * @param Object settings - Settings for campaign.
     * @returns {CampaignAPIStatistics} An instance of hm.campaign.API.Statistics.
     */
    context.CampaignAPIStatistics = function CampaignAPIStatistics(settings) {
        /************************************ Public variables ************************************/
        /**
         * @private
         */
        var internal = {};
        var external = {};

        internal.GLOBAL_ID = "GLOBAL";
        internal.CID_PREFIX = "FREEFORM_"; // Category ID Prefix
        internal.SEPARATOR = " : ";

        internal.category = "";
        internal.page = "";
        internal.elementPage = "";

        internal.frameworkTimerStarted = 0;

        /* *********************************** Private methods *********************************** */
        internal.showError = function (message) {
            if (typeof settings.isLocal != 'undefined' && settings.isLocal) {
                alert(message);
            }
            else {
                console.error(message);
            }
        };

        internal.init = function init() {
            internal.category = hm.campaign_data.campaignId;
        };

        /* *********************************** Public methods *********************************** */

        /**
         * Will track a pageview. A pageview commonly occurs when a new page or section is shown/loaded.
         * @memberOf hm.campaign.API.Statistics
         * @name trackPage
         * @function
         *
         * @param {String} trackingValue - The value to be registered on the pageview
         * @example <caption>Page without sections</caption>
         * hm.campaign.API.Statistics.trackPage("COLLECTION")
         * @example <caption>Page with sections: Top of page / section one</caption>
         * hm.campaign.API.Statistics.trackPage("INSPIRATION : 1")
         * @example <caption>Page with sections: Section two</caption>
         * hm.campaign.API.Statistics.trackPage("INSPIRATION : 2")
         */
        external.trackPage = function trackPage(trackingValue) {
            if (internal.category === '') {
                internal.init();
            }

            var country = hm.campaign.api.locale.country;
            internal.page = internal.CID_PREFIX + internal.category + internal.SEPARATOR + trackingValue;
            internal.elementPage = internal.CID_PREFIX + internal.category + internal.SEPARATOR + trackingValue;

            hm.campaign.statistics.trackPage(
                internal.CID_PREFIX + internal.category,
                internal.page.toUpperCase()
            );
        };

        /**
         * @memberOf hm.campaign.API.Statistics
         * @name trackElement
         * @function
         *
         * @param {String} element - The element name to track
         * @param {Boolean} isGlobal - Set true on global level elements
         * @description Will track element interaction. An element is something that is interactable for the user. Most commonly
         * a button or a clickable image. An element can also be a global element, which means it is not relating to
         * a pageview. An example of a global element would be for example a share button for the a whole campaign.
         * The share button would for example always be visible and interaction with the button does not relatate to
         * a particular page. In contrast a non global button would be a share button located only on a specific page.
         * For example when sharing a specific product on that page.
         * @example hm.campaign.API.Statistics.trackElement('button-1')
         * @example hm.campaign.API.Statistics.trackElement('global-button', true)
         */
        external.trackElement = function trackElement(element, isGlobal) {
            if (internal.page === '') {
                internal.showError("Call hm.campaign.API.Statistics.trackPage() before calling trackElement().");
                return false;
            }

            var trackIdentifier = "";
            if (typeof isGlobal === 'undefined')
                isGlobal = false;

            if (!isGlobal) {
                trackIdentifier = internal.elementPage.toUpperCase();
            }
            else {
                trackIdentifier = internal.GLOBAL_ID;
            }

            hm.campaign.statistics.trackElement(
                internal.CID_PREFIX + internal.category,
                trackIdentifier,
                element.toUpperCase()
            );
        };


        /**
         * @memberOf hm.campaign.API.Statistics
         * @name interactionReady
         * @function
         *
         * @description Call this function as soon as the campaign is ready for end-user interaction.
         * The function tracks the elapsed time (miliseconds) from that campaign ready was fired from the framework, to that the campaign implementor calls this function.
         * @example hm.campaign.API.Statistics.interactionReady()
         **/
        external.interactionReady = function interactionReady(){
            if(internal.frameworkTimerStarted === 0){
                internal.frameworkTimerStarted++;
                internal.startInteractionTime = new Date().getTime();
            }
            else if (internal.frameworkTimerStarted === 1){
                internal.frameworkTimerStarted++;
                internal.elapsedInteractionTime = new Date().getTime() - internal.startInteractionTime;
                internal.trackInteractionTime(hm.campaign_data.campaignId, internal.elapsedInteractionTime.toString());
            }
        };

        internal.trackInteractionTime = function trackInteractionTime(campaignId, elapsedTime){
            if(typeof utag !== "undefined" && typeof utag.link !== "undefined"){
                utag.link({
                    "timing_category"   : 'User interaction',
                    "timing_variable"   : 'Load',
                    "timing_label"      : campaignId,
                    "timing_value"      : elapsedTime
                });
            }
        }

        return external;
    };

})(this, jQuery);

/**
 *  @author    Johannes Axner <johannes.axner@hm.com>
 *  @author    Linda Wagnerius <linda.wagnerius@hm.com>
 *  @author    Simon Nkangi <simon.nkangi@hm.com>
 *  @copyright Copyright (c) 2015 H&M
 *  @since     Version 2.0
 */
(function (context, $) {
    'use strict';
    /**
     *
     * H&M Campaign public
     *
     * @memberOf hm.campaign.API
     * @name Texts
     * @class
     * @param Object settings - Settings for campaign.
     * @returns {CampaignTexts} An instance of hm.campaign.API.Texts.
     */
    context.CampaignTexts = function (settings) {
        /************************************ Public variables ************************************/
        /**
         * @private
         */
        var internal = {};
        var external = {};

        /**
         * Retrieves the specified key from language translation data.
         * @memberOf hm.campaign.API.Texts
         * @name get
         * @function
         * @param {String} key - Key to retrieve from language data.
         * @returns {String} The retrieved text string.
         */
        external.get = function get(key) {
            key = key.replace(/\./g, '_');
            return $('#campaign-copy')
                .find('.campaign-copy-' + key)
                .text() || key + ': NOT DEFINED';
        };

        return external;
    };
})(this, jQuery);

window.hm=window.hm||{},window.hm.videoplayer=function($){"use strict";var internal={},external={},_defaults;return internal.players={},internal.videosToBeLoaded=[],internal.timeOutId="",internal.timeOutProgressBarId="",internal.youtubeApiLoaded=!1,internal.autoplayOnLoad=!1,internal.muted=!1,_defaults={backgroundcolor:"#000000",autoplay:!1,loop:!1,numLoops:0,skin:"light",chrome:!0,device:"desktop",minWidth:320,minHeight:180,width:480,height:270,title:"Title"},_defaults.youtube={autoplay:_defaults.autoplay,related:!1,showinfo:!1,color:"red",controls:1,language:"en",width:_defaults.width,height:_defaults.height,minWidth:_defaults.minWidth,minHeight:_defaults.minHeight,title:_defaults.title},_defaults.youku={width:_defaults.width,height:_defaults.height,minWidth:_defaults.minWidth,minHeight:_defaults.minHeight+40},external.create=function(a,b,c,d){return external.hasInstance(b)?void internal.debug("Fatal Error: Video player ID already in use!"):internal.render(a,b,c,d)},external.createYoutube=function(a,b){return external.hasInstance(a)?void internal.debug("Fatal Error: Video player ID already in use!"):void internal.renderYoutube(a,b)},external.createYouku=function(a,b,c){return external.hasInstance(b)?void internal.debug("Fatal Error: Video player ID already in use!"):void internal.renderYouku(a,b,c)},external.destroy=function(){var a,b,c=arguments.length;if(0===c)for(a in internal.players)internal.destroyInstance(a);else for(b=0;c>b;b++)internal.destroyInstance(arguments[b])},external.getInstance=function(a){return"undefined"!=typeof internal.players[a]?internal.players[a].video:void 0},external.getInstanceObject=function(a){return internal.getInstanceObject(a)},external.getInstanceType=function(a){return internal.getInstanceType(a)},external.getPlayers=function(){return internal.players},external.hasInstance=function(a){var b;for(b in internal.players)if(b===a)return!0;return!1},external.isHD=function(a){var b=external.getInstanceObject(a);if("undefined"!=typeof b)return b.settings.hasHD?b.settings.hd:!1},external.isHtml=function(a){return external.hasInstance(a)?internal.players[a]&&"html"===internal.players[a].type:void 0},external.isPlaying=function(a){var b=external.getInstance(a);if("undefined"!=typeof b&&!external.isYoutube(a))return!b.paused&&!b.ended&&b.readyState>2&&b.currentTime>0?!0:!1},external.isYoutube=function(a){return external.hasInstance(a)?internal.players[a]&&"youtube"===internal.players[a].type:void 0},external.isYouku=function(a){return external.hasInstance(a)?internal.players[a]&&"youku"===internal.players[a].type:void 0},external.parseDOM=function(){var a=$(".htmlvideo-widget"),b=$(".youtube-widget"),c=$(".youku-widget");a.length>0&&a.each(function(a,b){var c=$(b),d=Boolean(c.data("autoplay"))||_defaults.autoplay,e=Boolean(c.data("loop"))||_defaults.loop,f="#"+c.attr("id"),g=c.data("id")||"",h=c.data("width")||"",i=c.data("height")||"",j=c.data("mp4")||"",k=c.data("mp4hd")||"",l=c.data("webm")||"",m=c.data("webmhd")||"",n=c.data("fallback")||"",o=c.data("error-message")||"",p=c.data("backgroundcolor")||_defaults.backgroundcolor,q=c.data("poster")||"",r=c.data("skin")||_defaults.skin,s="undefined"!=typeof c.data("chrome")?Boolean(c.data("chrome")):_defaults.chrome,t="undefined"!=typeof c.data("device")?c.data("device"):_defaults.device,u="undefined"!=typeof c.data("title")?c.data("title"):_defaults,v={};v.autoplay=d,v.loop=e,v.width=h,v.height=i,v.mp4=j,v.mp4hd=k,v.webm=l,v.webmhd=m,v.fallback=n,v.errorMessage=o,v.backgroundColor=p,v.poster=q,v.skin=r,v.chrome=s,v.device=t,v.title=u,c.removeAttr("data-autoplay"),c.removeAttr("data-loop"),c.removeAttr("data-id"),c.removeAttr("data-width"),c.removeAttr("data-height"),c.removeAttr("data-mp4"),c.removeAttr("data-mp4hd"),c.removeAttr("data-webm"),c.removeAttr("data-webmhd"),c.removeAttr("data-fallback"),c.removeAttr("data-error-message"),c.removeAttr("data-backgroundcolor"),c.removeAttr("data-poster"),c.removeAttr("data-hd-video"),c.removeAttr("data-chrome"),c.removeAttr("data-device"),c.removeAttr("data-title"),c.removeClass("htmlvideo-widget"),internal.render(f,g,v,!0)}),b.length>0&&b.each(function(a,b){var c=$(b),d=c.attr("id"),e={};e.video=c.data("video"),e.width="undefined"!=typeof c.data("width")?Number(c.data("width")):_defaults.youtube.width,e.height="undefined"!=typeof c.data("height")?Number(c.data("height")):_defaults.youtube.height,e.autoplay="undefined"!=typeof c.data("autoplay")?Boolean(c.data("autoplay")):_defaults.youtube.auotplay,e.related="undefined"!=typeof c.data("related")?Boolean(c.data("related")):_defaults.youtube.related,e.showinfo="undefined"!=typeof c.data("showinfo")?Boolean(c.data("showinfo")):_defaults.youtube.showinfo,e.title="undefined"!=typeof c.data("title")?c.data("title"):_defaults.youtube.title,e.color="undefined"!=typeof c.data("color")?c.data("color"):_defaults.youtube.color,e.controls="undefined"!=typeof c.data("controls")?Number(c.data("controls")):_defaults.youtube.controls,e.language="undefined"!=typeof c.data("language")?c.data("language"):_defaults.youtube.language,internal.renderYoutube(d,e)}),c.length>0&&c.each(function(a,b){var c=$(b),d=c.attr("id"),e=c.data("id")||"youkuVideo",f={};f.vid=c.data("video"),"undefined"!=typeof c.data("clientId")&&(f.clientId=c.data("clientId")),"undefined"!=typeof c.data("width")&&(f.width=Number(c.data("width"))),"undefined"!=typeof c.data("height")&&(f.height=Number(c.data("height"))),"undefined"!=typeof c.data("autoplay")&&(f.autoplay=Boolean(c.data("autoplay"))),"undefined"!=typeof c.data("show-related")&&(f.show_related=Boolean(c.data("show-related"))),"undefined"!=typeof c.data("on-play-start")&&(f.events=f.events||{},f.events.onPlayStart=c.data("on-play-start")),"undefined"!=typeof c.data("on-player-ready")&&(f.events=f.events||{},f.events.onPlayerReady=c.data("on-player-ready")),"undefined"!=typeof c.data("on-play-end")&&(f.events=f.events||{},f.events.onPlayEnd=c.data("on-play-end")),internal.renderYouku(d,e,f)})},external.toggleHD=function(a,b){var c=external.getInstanceObject(a);if("undefined"!=typeof c){var d=$(c.video),e=external.isPlaying(a);if(c.settings.hasHD)return c.video.pause(),c.settings.hd="undefined"!=typeof b?Boolean(b):!c.settings.hd,c.settings.hd?(d.find('source[type="video/mp4"]').attr("src",c.settings.mp4hd),d.find('source[type="video/webm"]').attr("src",c.settings.webmhd),d.attr("src",c.settings.mp4hd)):(d.find('source[type="video/mp4"]').attr("src",c.settings.mp4),d.find('source[type="video/webm"]').attr("src",c.settings.webm),d.attr("src",c.settings.mp4)),c.video.load(),e&&(c.video.play(),internal.autoplayOnLoad=!0),c.settings.hd}},external.update=function(a,b){console.info("Update is deprecated!");var c,d,e,f,g,h=$(external.getInstance(a)),i=h.parent(),j=!1;internal.testSettings(b)&&(b.chrome||i.addClass("chromeless"),"undefined"!=typeof b.poster&&(b.poster.length?h.attr("poster",b.poster):h.removeAttr("poster")),"undefined"!=typeof b.skin&&b.skin.length&&internal.setSkin(i,b.skin),h.attr("width",b.width),h.attr("height",b.height),i.css("width",b.width),i.css("height",b.height),h.data("autofit","width"),j=!0,j&&internal.resize(h),"undefined"!=typeof b.backgroundColor&&b.backgroundColor&&i.find(".htmlvideo-background").css("background-color",b.backgroundColor),"undefined"!=typeof b.mp4&&b.mp4&&(c=h.find('source[type="video/mp4"]')||$('<source type="video/mp4">'),c.attr("src")&&c.attr("src")===b.mp4||external.isHD(a)||(c.detach().attr("src",b.mp4).prependTo(h),h.removeAttr("src"),g=b.mp4)),"undefined"!=typeof b.mp4hd&&b.mp4hd?(b.hasHD=!0,h.parent().find(".htmlvideo-control-bar").addClass("hd-video"),d=h.find('source[type="video/mp4"]')||$('<source type="video/mp4">'),d.attr("src")&&d.attr("src")===b.mp4hd||!external.isHD(a)||(d.detach().attr("src",b.mp4hd).prependTo(h),h.removeAttr("src"),g=b.mp4hd)):h.parent().find(".htmlvideo-control-bar").removeClass("hd-video"),"undefined"!=typeof b.webm&&b.webm&&(e=h.find('source[type="video/webm"]')||$('<source type="video/webm">'),e.attr("src")&&e.attr("src")===b.webm||external.isHD(a)||(e.detach().attr("src",b.webm).prependTo(h),h.removeAttr("src"),g=b.webm)),"undefined"!=typeof b.webmhd&&b.webmhd&&(f=h.find('source[type="video/webm"]')||$('<source type="video/webm">'),f.attr("src")&&f.attr("src")===b.webmhd||!external.isHD(a)||(f.detach().attr("src",b.webmhd).prependTo(h),h.removeAttr("src"),g=b.webmhd)),"undefined"!=typeof b.autoplay&&Boolean(h.attr("autoplay"))!==Boolean(b.autoplay)&&h.attr("autoplay",b.autoplay),"undefined"!=typeof b.loop&&(Boolean(b.loop)?h.attr("loop",!0):h.removeAttr("loop")),"undefined"!=typeof b.fallback&&b.fallback&&h.find(".fallback").text(b.fallback),g=g||"",internal.getInstanceObject(a).settings=b)},external.updateYoutube=function(a,b){console.info("UpdateYoutube is deprecated!");var c=hm.videoplayer.getInstance(a),d=external.getInstanceObject(a).settings;c.getIframe().width=b.width,c.getIframe().height=b.height,b=$.extend({},d,b),internal.getInstanceObject(a).settings=b},external.updateYouku=function(a,b){console.info("UpdateYouku is deprecated!");var c=hm.videoplayer.getInstance(a),d=external.getInstanceObject(a).settings;c.width=b.width,c.height=b.height,b=$.extend({},d,b),internal.destroyInstance(a,!0),external.createYouku(a,a,b)},external.resize=function(a){internal.resize($("#"+a))},internal.fullscreenAvailable=function(a){return a.requestFullscreen||a.mozRequestFullscreen||a.webkitRequestFullscreen||a.msRequestFullscreen||a.webkitSupportsFullscreen||Boolean(a.mozRequestFullScreen)},internal.addBackground=function(a,b){a.prepend('<div class="htmlvideo-background" style="background-color: '+b+'; position: absolute;top: 0; left: 0;z-index: 1;width:100%;height:100%;"></div>'),a.find("video").css("background",b)},internal.handleFullscreen=function(a){var b=$("#"+a),c=b.parents(".htmlvideo-wrapper"),d=c.find(".htmlvideo-fullscreen-toggle"),e=external.getInstanceObject(a).settings.chrome,f=navigator.userAgent.indexOf("Firefox")>-1;if(d.hasClass("htmlvideo-fullscreen-off"))internal.setFullscreenData(c,!0),f&&(c.addClass("chromeless"),b.attr("controls","controls")),f||e||c.removeClass("chromeless"),d.removeClass("htmlvideo-fullscreen-off").addClass("htmlvideo-fullscreen-on");else if(d.hasClass("htmlvideo-fullscreen-on")){internal.setFullscreenData(c,!1),f&&(b.removeAttr("controls"),e&&c.removeClass("chromeless")),f||e||c.addClass("chromeless"),d.removeClass("htmlvideo-fullscreen-on").addClass("htmlvideo-fullscreen-off");var g=!!navigator.userAgent.match(/Trident.*rv[ :]*11\./);g&&b.removeAttr("controls")}},internal.latestMozFullscreenElementId="",internal.latestMsFullscreenElementId="",internal.addMozFullscreenListener=function(){$(document).on("mozfullscreenchange",function(){document.mozFullScreenElement&&(internal.latestMozFullscreenElementId=document.mozFullScreenElement.id),internal.handleFullscreen(internal.latestMozFullscreenElementId)}).on("MSFullscreenChange",function(){document.msFullscreenElement&&(internal.latestMsFullscreenElementId=document.msFullscreenElement.id),internal.handleFullscreen(internal.latestMsFullscreenElementId)})},internal.addMozFullscreenListener(),internal.addEventHandlers=function(a){function b(){a.get(0).currentTime=0,l.chrome&&(n.css("opacity","1"),n.css("display","block"),n.addClass("large-play-button-initial-state").addClass("large-play-button-paused").removeClass("large-play-button-playing"),o.removeClass("htmlvideo-state-pause").addClass("htmlvideo-state-play"),p.fadeOut()),l.loop?(l.numLoops++,a.get(0).play()):a.get(0).pause()}function c(){l.chrome&&(u.removeClass("htmlvideo-state-pause").addClass("htmlvideo-state-play"),n.removeClass("large-play-button-playing").addClass("large-play-button-paused"),internal.showControlBar(p,a.get(0).readyState),clearTimeout(internal.timeOutProgressBarId)),internal.sendTracking(a.get(0).id,internal.getInstanceObject(a.get(0).id).settings.title,"video_pause",a.get(0).duration,a.get(0).currentTime)}function d(){l.chrome&&(n.hasClass("large-play-button-initial-state")&&(internal.fullscreenAvailable(a.get(0))||p.addClass("fullscreen-not-supported"),n.removeClass("large-play-button-initial-state"),a.parents().hasClass("desktop")||a.attr("controls","controls")),n.hasClass("large-play-button-paused")?(a.get(0).play(),n.removeClass("large-play-button-paused").addClass("large-play-button-playing"),n.css("opacity","0"),n.css("display","none"),v.addClass("htmlvideo-state-pause").removeClass("htmlvideo-state-play"),internal.showControlBar(p,a.get(0).readyState),clearTimeout(internal.timeOutProgressBarId),internal.timeOutProgressBarId=setTimeout(function(){internal.timeOutProgressBar(p)},4e3)):n.hasClass("large-play-button-playing")&&(a.get(0).pause(),n.removeClass("large-play-button-playing").addClass("large-play-button-paused"),u.removeClass("htmlvideo-state-play").addClass("htmlvideo-state-pause"),internal.showControlBar(p,a.get(0).readyState),clearTimeout(internal.timeOutProgressBarId))),internal.getInstanceObject(a.get(0).id).settings.autoplay?(internal.sendTracking(a.get(0).id,internal.getInstanceObject(a.get(0).id).settings.title,"video_autostart"),internal.getInstanceObject(a.get(0).id).settings.autoplay=!1):internal.sendTracking(a.get(0).id,internal.getInstanceObject(a.get(0).id).settings.title,"video_start")}function e(){if(l.chrome){y.css("visibility","hidden");var b=100/a.get(0).duration*a.get(0).currentTime;s.css("width",b+"%");var c=a.get(0).currentTime,d=a.get(0).duration-a.get(0).currentTime;q.html(internal.getTimeFormat(c)+"&nbsp;/&nbsp;"),r.html(isNaN(a.get(0).duration)?"00:00":internal.getTimeFormat(d))}}function f(){if(l.chrome){if(a.get(0).readyState>0){var b=a.get(0).buffered.end(0),c=100*b/a.get(0).duration;t.css("width",Math.round(c)+"%")}internal.resize(a)}}function g(){if(l.chrome)if(a.prop("muted"))w.removeClass("htmlvideo-volume").addClass("htmlvideo-mute"),x.css("height","77px");else{w.removeClass("htmlvideo-mute").addClass("htmlvideo-volume");var b=77-77*a.get(0).volume;x.css("height",b+"px")}}function h(){}function i(){}function j(a){internal.handleFullscreen(a.target.id)}function k(){internal.resize(a),internal.autoplayOnLoad&&(a.get(0).play(),internal.autoplayOnLoad=!1)}var l=internal.getInstanceObject(a.get(0).id).settings,m=a.parents(".htmlvideo-wrapper");if(l.chrome)var n=m.find(".large-play-button"),o=m.find(".htmlvideo-state-play"),p=m.find(".htmlvideo-control-bar"),q=m.find(".htmlvideo-elapsed"),r=m.find(".htmlvideo-duration"),s=m.find(".htmlvideo-progress"),t=m.find(".htmlvideo-buffer"),u=m.find(".htmlvideo-play-pause"),v=m.find(".htmlvideo-state-play"),w=m.find(".htmlvideo-volume-mute"),x=m.find(".htmlvideo-volume-state"),y=m.find(".htmlvideo-loader");else a.on("dblclick",function(){internal.toggleFullscreen($(this),a.get(0)),m.hasClass("htmlvideo-chromeless-fullscreen-off")?m.removeClass("htmlvideo-chromeless-fullscreen-off").addClass("htmlvideo-chromeless-fullscreen-on"):m.hasClass("htmlvideo-chromeless-fullscreen-on")&&m.removeClass("htmlvideo-chromeless-fullscreen-on").addClass("htmlvideo-chromeless-fullscreen-off")}),a.on("click",function(){external.isPlaying(a.get(0).id)?a.get(0).pause():a.get(0).play()});a.get(0).addEventListener("ended",b),a.get(0).addEventListener("pause",c),a.get(0).addEventListener("play",d),a.get(0).addEventListener("timeupdate",e),a.get(0).addEventListener("progress",f),a.get(0).addEventListener("volumechange",g),a.get(0).addEventListener("waiting",i),a.get(0).addEventListener("canplay",h),a.get(0).addEventListener("webkitfullscreenchange",j),a.get(0).addEventListener("durationchange",k),a.get(0).addEventListener("loadedmetadata",k)},external.sendTracking=function(a,b,c,d,e){internal.sendTracking(a,b,c,d,e)},internal.sendTracking=function(a,b,c,d,e){var f=internal.getInstanceObject(a);if(!(f.settings.numLoops>0&&("video_pause"===c&&d===e||"video_start"===c))){"undefined"!=typeof hm.campaign_data&&(b=hm.campaign_data.campaignId+" "+b);var g={event_label:b,event_type:c,event_category:"Video"},h={video_completed:"Completed",video_stop:"Stopped",video_start:"Started",video_pause:"Paused",video_autostart:"Started"};if("video_pause"===c&&d===e&&(c="video_completed"),g.event_type=c.toUpperCase(),g.event_id=h[c],"video_pause"===c){var i,j=Math.round(e/d*100);25>=j?i="25%":j>25&&50>=j?i="50%":j>50&&75>=j?i="75%":j>75&&(i="100%"),g.event_id=i;var k="youtube"===internal.getInstanceType(a)?f.video.a:f.video,l={id:a,duration:d,offset:e};internal.dispatchCustomEvent("pause_tracking_sent",k,l)}("video_stop"===c||"video_completed"===c)&&(g.event_id="100%"),"undefined"!=typeof utag&&utag.link(g)}},internal.addInterfaceListeners=function(a){var b=$(a),c=b.parents(".htmlvideo-wrapper"),d=c.find(".htmlvideo-control-bar"),e=c.find(".large-play-button"),f=c.find(".htmlvideo-play-pause"),g=c.find(".htmlvideo-volume-mute"),h=c.find(".htmlvideo-sound-control"),i=c.find(".htmlvideo-progress-bar"),j=c.find(".htmlvideo-fullscreen-toggle"),k=b.parents(".mobile").find(".large-play-button"),l=c.find(".htmlvideo-hd");l.on("click",function(){l.toggleClass("hd-active"),external.toggleHD(b.get(0).id)}),k.on("click",function(){e.hasClass("large-play-button-paused")?(b.get(0).play(),internal.toggleFullscreen(j,b.get(0))):e.hasClass("large-play-button-playing")&&b.get(0).pause()}),e.on("click",function(){e.hasClass("large-play-button-paused")&&b.get(0).play()}),b.on("click",function(){e.hasClass("large-play-button-paused")?b.get(0).play():e.hasClass("large-play-button-playing")&&b.get(0).pause()}),f.on("click",function(){$(this).hasClass("htmlvideo-state-play")?b.get(0).play():b.get(0).pause()}),g.on("click",function(){$(this).hasClass("htmlvideo-volume")?b.prop("muted",!0):b.prop("muted",!1)}),j.on("click",function(){internal.toggleFullscreen($(this),b.get(0))}),b.on("dblclick",function(){internal.toggleFullscreen($(this).parent().find(".htmlvideo-fullscreen-toggle"),b.get(0))}),g.on("mouseover",function(){h.css("visibility","visible")}),g.on("mouseout",function(){h.css("visibility","hidden")}),h.on("mouseover",function(){$(this).css("visibility","visible")}),h.on("mouseout",function(){$(this).css("visibility","hidden")}),i.on("mousemove",function(a){var c=void 0===a.offsetX?a.originalEvent.layerX:a.offsetX,d=internal.getPercentage(c,$(this).width()),e=internal.getCurrentSeconds(d,b.get(0).duration),f=internal.getTimeFormat(e);$(this).find(".htmlvideo-current-time").css("left",c).html(f)}),i.on("mouseover touchstart",function(){$(this).find(".htmlvideo-current-time").css("visibility","visible"),clearTimeout(internal.timeOutId)}),i.on("mouseout touchstart",function(){var a=$(this).find(".htmlvideo-current-time");clearTimeout(internal.timeOutId),internal.timeOutId=setTimeout(function(){internal.timeOutFunction(a)},500)}),i.on("click",function(a){var c=internal.getPercentage(void 0===a.offsetX?a.originalEvent.layerX:a.offsetX,$(this).width()),d=internal.getCurrentSeconds(c,b.get(0).duration);b.get(0).currentTime=d,external.isPlaying(b.get(0).id)&&b.get(0).play()}),h.on("click",function(a){var c=void 0===a.offsetY?a.originalEvent.layerY:a.offsetY,d=1-internal.getPercentage(c,77);b.get(0).volume=d}),c.on("mouseover",function(){var a=$(this).find(".htmlvideo-control-bar");$(this).find(".large-play-button").hasClass("large-play-button-initial-state")||(clearTimeout(internal.timeOutProgressBarId),internal.showControlBar(a,b.get(0).readyState),internal.timeOutProgressBarId=setTimeout(function(){internal.timeOutProgressBar(a)},4e3))}),c.on("mousemove",function(){var a=$(this).find(".htmlvideo-control-bar");$(this).find(".large-play-button").hasClass("large-play-button-initial-state")||(clearTimeout(internal.timeOutProgressBarId),internal.showControlBar(a,b.get(0).readyState),internal.timeOutProgressBarId=setTimeout(function(){internal.timeOutProgressBar(a)},4e3))}),c.on("mouseout",function(){var a=$(this).find(".htmlvideo-control-bar");clearTimeout(internal.timeOutProgressBarId),internal.timeOutProgressBarId=setTimeout(function(){internal.timeOutProgressBar(a)},4e3)}),d.on("mouseover mousemove mouseout",function(a){return clearTimeout(internal.timeOutProgressBarId),a.stopPropagation(),!1})},internal.addUserInterface=function(a){a.append('<div class="large-play-button large-play-button-initial-state large-play-button-paused"></div>')},internal.debug=function(){var a,b=[];if(console&&console.log){for(a in arguments)b.push(arguments[a]);console.log(b)}},internal.destroyInstance=function(a,b){if("youtube"===external.getInstanceType(a)){var c=$("#"+a);internal.dispatchCustomEvent("destroy",c.get(0)),c.remove(),delete internal.players[a]}else if("youku"===external.getInstanceType(a)){var d=$("#"+a);internal.dispatchCustomEvent("destroy",d.get(0)),b?(d.empty(),internal.removeDataAttributes(["data-id","data-video","data-width","data-show-related"],d),$("#youku-script").remove()):(d.remove(),$("#youku-script").remove()),delete internal.players[a],delete window.YKU}else{var e=external.getInstance(a);if("undefined"==typeof e)return;var f=$(e);if(internal.dispatchCustomEvent("destroy",f.get(0)),"undefined"!=typeof e){f.off(),f.find("*").off(),e.pause&&e.pause();var g=f.parent(".htmlvideo-wrapper");delete internal.players[f.attr("id")],g.remove()}}},internal.dispatchCustomEvent=function(a,b,c){var d;document.createEvent?(d=document.createEvent("HTMLEvents"),d.initEvent(a,!0,!0)):document.createEventObject&&(d=document.createEventObject(),d.eventType=a),null!==c&&c&&(d.data=c),b.dispatchEvent(d)},internal.setFullscreenData=function(a,b){a.attr("data-fullscreen",!!b)},internal.toggleFullscreen=function(a,b){$(b).css("background","#000"),a.hasClass("htmlvideo-fullscreen-off")||a.parents().hasClass("htmlvideo-chromeless-fullscreen-off")?b.requestFullscreen?b.requestFullscreen():Boolean(b.mozRequestFullScreen)?b.mozRequestFullScreen():b.webkitRequestFullscreen?b.webkitRequestFullscreen():b.webkitSupportsFullscreen?b.webkitEnterFullscreen():b.msRequestFullscreen&&($(b).attr("controls","controls"),b.msRequestFullscreen()):(a.hasClass("htmlvideo-fullscreen-on")||a.parents().hasClass("htmlvideo-chromeless-fullscreen-on"))&&($(b).css("background",external.getInstanceObject($(b).attr("id")).settings.backgroundColor),document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullscreen?document.webkitCancelFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen())},internal.getCurrentSeconds=function(a,b){return b*a},internal.getInstanceObject=function(a){return internal.players[a]},internal.getInstanceType=function(a){return external.hasInstance(a)?internal.players[a].type:void 0},internal.getPercentage=function(a,b){var c=a/b;return Math.round(100*c)/100},internal.getTimeFormat=function(a){var b=a,c=parseInt(b/3600),d=parseInt(b/60)%60,e=Math.round(b%60);return(1>c?"":c+":")+(10>d?"0"+d:d)+":"+(10>e?"0"+e:e)},internal.init=function(){external.parseDOM()},internal.register=function(a,b,c,d){internal.players[a]={video:"youtube"===d||"youku"===d?b:b.get(0),settings:c,type:d}},internal.resize=function(a){a.parents(".htmlvideo-wrapper").css("overflow","hidden"),a.css("width","100%"),a.css("position","relative"),a.css("top","50%"),a.css("left",""),a.css("margin-left",""),a.css("margin-top",-(a.get(0).height/2))},internal.getExtension=function(a){return a.split(".").pop().toLowerCase()},internal.testSettings=function(a){return null!==a&&a?null!==a.title&&a.title?null!==a.width&&a.width?null!==a.height&&a.height?null!==a.mp4&&a.mp4?"undefined"!=typeof a.mp4&&a.mp4.length&&"mp4"!==internal.getExtension(a.mp4)?(internal.debug("Fatal Error: MP4 source doesn't have .mp4 extension!"),!1):"undefined"!=typeof a.mp4hd&&a.mp4hd.length&&"mp4"!==internal.getExtension(a.mp4hd)?(internal.debug("Fatal Error: MP4 HD source doesn't have .mp4 extension!"),!1):"undefined"!=typeof a.webm&&a.webm.length&&"webm"!==internal.getExtension(a.mp4hd)?(internal.debug("Fatal Error: WebM source doesn't have .webm extension!"),!1):"undefined"!=typeof a.webmhd&&a.webmhd.length&&"webm"!==internal.getExtension(a.mp4hd)?(internal.debug("Fatal Error: WebM HD source doesn't have .webm extension!"),!1):!0:(internal.debug("Fatal Error: No MP4 source is provided for video player!"),!1):(internal.debug("Fatal Error: No height provided for video player!"),!1):(internal.debug("Fatal Error: No width provided for video player!"),!1):(internal.debug("Fatal Error: No title provided for video player!"),!1):(internal.debug("Fatal Error: Settings for video player missing or empty!"),!1)},internal.render=function(a,b,c,d){if(null===a||!a||!a.length)return void internal.debug("Fatal Error: Container for video player missing or empty!");if(!internal.supportsVideo())return void $(a).append(c.fallback);if(null===b||!b||!b.length)return void internal.debug("Fatal Error: Id for video player missing or empty!");if(c=internal.fixSize(c,_defaults),c.autoplay="undefined"!=typeof c.autoplay?Boolean(c.autoplay):_defaults.autoplay,c.loop="undefined"!=typeof c.loop?Boolean(c.loop):_defaults.loop,c.numLoops="undefined"!=typeof c.numLoops?c.numLoops:_defaults.numLoops,c.chrome="undefined"!=typeof c.chrome?Boolean(c.chrome):_defaults.chrome,c.theme="undefined"!=typeof c.theme&&"dark"===c.theme?"dark":_defaults.skin,c.device="undefined"!=typeof c.device?c.device:_defaults.device,c.title="undefined"!=typeof c.title?c.title:_defaults.title,internal.testSettings(c)){var e=$(a),f=$('<div class="htmlvideo-wrapper"></div>'),g=$('<video style="position: relative; z-index: 2;"></video>'),h={mp4:$('<source type="video/mp4" class="source-mp4">'),webm:$('<source type="video/webm" class="source-webm">')},i=$('<div class="fallback"></div>'),j=$('<div class="error-message">Something went wrong! Couldn\'t load video.</div>');if(c.autoplay&&g.attr("autoplay",!0),c.chrome&&"desktop"!==c.device)g.attr("controls","controls"),g.attr("preload","none");else if(c.chrome&&"desktop"===c.device){var k=$('<div class="htmlvideo-control-bar">   <div class="htmlvideo-sound-control">       <div class="htmlvideo-volume-bar"></div>       <div class="htmlvideo-volume-state"></div>   </div>   <div class="htmlvideo-play-pause htmlvideo-state-play"></div>   <div class="htmlvideo-progress-bar">       <div class="htmlvideo-current-time"></div>       <div class="htmlvideo-buffer"></div>       <div class="htmlvideo-progress"></div>   </div>   <div class="htmlvideo-time">       <div class="htmlvideo-elapsed"></div>       <div class="htmlvideo-duration"></div>   </div>   <div class="htmlvideo-hd"></div>   <div class="htmlvideo-volume-mute htmlvideo-volume"></div>   <div class="htmlvideo-fullscreen-toggle htmlvideo-fullscreen-off"></div></div>');c.hasHD=Boolean(c.mp4&&c.mp4hd||c.webm&&c.webmhd),c.hd=!1,c.hasHD&&k.addClass("hd-video"),internal.fullscreenAvailable(g.get(0))||k.addClass("fullscreen-not-supported"),internal.setSkin(f,c.skin)}return g.attr("id",b),g.prop("volume",.5),f.css("width",c.width),f.css("height",c.height),g.attr("width",c.width),g.attr("height",c.height),g.css("width","100%"),c.poster&&g.attr("poster",c.poster),c.mp4&&(h.mp4.attr("src",c.mp4),g.append(h.mp4)),c.fallback&&i.text(c.fallback),c.errorMessage&&j.text(c.errorMessage),f.prepend(j),g.append(i),("tablet"===c.device||"mobile"===c.device||"desktop"===c.device)&&f.addClass(c.device),d?(f.attr("id",e.attr("id")),f.attr("class",f.attr("class")+" "+e.attr("class")),e.replaceWith(f)):e.append(f),g.data("autofit","width"),f.append(g),"desktop"===c.device&&(f.append(k),c.chrome||f.addClass("chromeless")),c.backgroundColor=c.backgroundColor||"#000",internal.addBackground(f,c.backgroundColor),internal.register(b,g,c,"html"),c.chrome&&"desktop"===c.device?(internal.addUserInterface(f),internal.addInterfaceListeners(g),internal.addEventHandlers(g)):c.chrome||"desktop"!==c.device?"tablet"===c.device&&internal.addEventHandlers(g):(f.addClass("htmlvideo-chromeless-fullscreen-off"),internal.addEventHandlers(g)),internal.dispatchCustomEvent("render",g.get(0)),g}},internal.renderYoutube=function(a,b){internal.loadYoutubePlayer(a,b)},internal.validateYoutubeSettings=function(a,b){return null!==a&&a&&a.length?$("#"+a).length?null!==b&&b?null!==b.video&&b.video?null!==b.title&&b.title?void 0:void internal.debug("Fatal Error: No title provided for Youtube player!"):void internal.debug("Fatal Error: No video provided for Youtube player!"):void internal.debug("Fatal Error: Settings for Youtube player missing or empty!"):void internal.debug("Fatal Error: Container with id "+a+" does not exist."):void internal.debug("Fatal Error: Id ("+a+") for Youtube player missing or empty!")},internal.validateYoukuSettings=function(a,b){return $("#"+a).length?null!==a&&a&&a.length?null!==b&&b?null!==b.vid&&b.vid||null!==b.video&&b.video?void("undefined"!=typeof b.vid&&"undefined"!=typeof b.video&&(delete b.video,console.warn("Warning: You only need to supply settings.vid or settings.video (not both). Will use the value for settings.vid and ignore settings.video"))):void internal.debug("Fatal Error: No video provided for Youku player!"):void internal.debug("Fatal Error: Settings for Youku player missing or empty!"):void internal.debug("Fatal Error: Id for Youku player missing or empty!"):void internal.debug("Fatal Error: Container with id "+a+" does not exist.")},internal.loadYoutubePlayer=function(a,b){internal.fixSize(b,_defaults.youtube),internal.validateYoutubeSettings(a,b);var c;internal.youtubeApiLoaded?internal.loadHTMLYoutubePlayer(c,a,b):(internal.videosToBeLoaded.push({widget:c,id:a,settings:b}),internal.loadYouTubeApi()),window.onYouTubePlayerAPIReady=function(){internal.youtubeApiLoaded=!0,$.each(internal.videosToBeLoaded,function(a,b){internal.loadHTMLYoutubePlayer(b.widget,b.id,b.settings)}),internal.dispatchCustomEvent("youtubeVideosLoaded",window)}},internal.loadYouTubeApi=function(){if($('script[src="//www.youtube.com/player_api"]').length<=0){var a=document.createElement("script");a.src="https://www.youtube.com/player_api";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}},internal.loadYoukuApi=function(){if($('script[src="http://player.youku.com/jsapi"]').length<=0&&$('script[src="https://players.youku.com/jsapi"]').length<=0){var a="http://player.youku.com/jsapi";"https:"===location.protocol&&(a="https://players.youku.com/jsapi");var b=document.createElement("script");b.src=a,b.id="youku-script";var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}},window.onPlayerReady=function(){},window.onPlayerStateChange=function(){},internal.loadHTMLYoutubePlayer=function(a,b,c){var d=function(a){-1===a.data&&internal.dispatchCustomEvent("onPlayerStateChange",window,-1),0===a.data&&(internal.sendTracking(b,internal.getInstanceObject(b).settings.title,"video_completed"),internal.dispatchCustomEvent("onPlayerStateChange",window,0)),1===a.data&&(internal.getInstanceObject(b).settings.autoplay?(internal.sendTracking(b,internal.getInstanceObject(b).settings.title,"video_autostart"),internal.getInstanceObject(b).settings.autoplay=!1):internal.sendTracking(b,internal.getInstanceObject(b).settings.title,"video_start"),internal.dispatchCustomEvent("onPlayerStateChange",window,1)),2===a.data&&(internal.sendTracking(b,internal.getInstanceObject(b).settings.title,"video_pause",a.target.getDuration(),a.target.getCurrentTime()),internal.dispatchCustomEvent("onPlayerStateChange",window,2)),3===a.data&&internal.dispatchCustomEvent("onPlayerStateChange",window,3)},e=new YT.Player(b,{playerVars:{playerapiid:b,rel:c.related,autoplay:c.autoplay,color:c.color,controls:c.controls,wmode:"opaque",html5:"1",showinfo:c.showinfo,enablejsapi:"1",modestbranding:"1",hl:c.language},height:c.height,width:c.width,videoId:c.video,events:{onReady:onPlayerReady,onStateChange:d}});internal.register(b,e,c,"youtube"),a=$("#"+b),internal.removeDataAttributes(["data-video","data-theme","data-width","data-height","data-title"],a),internal.dispatchCustomEvent("render",a.get(0))},internal.renderYouku=function(a,b,c){
internal.validateYoukuSettings(a,c),"undefined"==typeof c.vid&&(c.vid=c.video);var d,e,f;"undefined"!=typeof c.events&&("undefined"!=typeof c.events.onPlayStart&&(d=c.events.onPlayStart,delete c.events.onPlayStart),"undefined"!=typeof c.events.onPlayEnd&&(e=c.events.onPlayEnd,delete c.events.onPlayEnd),"undefined"!=typeof c.events.onPlayerReady&&(f=c.events.onPlayerReady,delete c.events.onPlayerReady)),jQuery.isEmptyObject(c.events)&&delete c.events,internal.youkuNumTries=0;var g=$("#"+a),h=c||{},i={styleid:"0",client_id:"872d663d12787d14",width:480,height:400,autoplay:!1,show_related:!0,NewPlayer:!0,events:{onPlayStart:function(){internal.getInstanceObject(b).settings.autoplay?internal.sendTracking(b,b,"video_autostart"):internal.sendTracking(b,b,"video_start"),internal.handleYoukuCallback(d)},onPlayerReady:function(){internal.handleYoukuCallback(f),"undefined"!=typeof hm.videoplayer.onYoukuPlayerReady&&hm.videoplayer.onYoukuPlayerReady(internal.youkuPlayer)},onPlayEnd:function(){internal.sendTracking(b,b,"video_completed"),internal.handleYoukuCallback(e)}}};jQuery.extend(i,h),h=i,h=internal.fixSize(h,_defaults.youku);var j=$('<div id="'+b+'" style="width:'+h.width+"px;height:"+h.height+'px"></div>');g.append(j),internal.loadYoukuApi(),internal.youkuFireWhenReady(b,h)},internal.fixSize=function(a,b){return"undefined"==typeof a.width?a.width=b.width:a.width<b.minWidth&&(a.width=b.minWidth),"undefined"==typeof a.height?a.height=b.height:a.height<b.minHeight&&(a.height=b.minHeight),a},internal.handleYoukuCallback=function handleYoukuCallback(callback){if("undefined"!=typeof callback){var func=eval("("+callback+")");"function"==typeof func&&func()}},internal.youkuFireWhenReady=function(a,b){"undefined"!=typeof YKU?internal.initYoukuPlayer(a,b):internal.youkuNumTries<21?(++internal.youkuNumTries,setTimeout(function(){internal.youkuFireWhenReady(a,b)},1e3)):console.error("[hm.videoplayer.js] Script load timeout: Youku script either cannot load or takes too long to load.")},internal.initYoukuPlayer=function(a,b){internal.youkuPlayer=new YKU.Player(a,b),internal.register(a,internal.youkuPlayer,b,"youku")},internal.removeDataAttributes=function(a,b){$.each(a,function(){b.removeAttr(this)})},internal.setSkin=function(a,b){var c=$(a);c.removeClass("light dark"),"dark"===b?c.addClass("dark"):"light"===b?c.addClass("light"):(c.addClass("light"),internal.debug("Notice: You have tried to use a non-existing skin: "+b))},internal.showControlBar=function(a,b){b>0&&(a.css("display","block"),a.css("visibility","visible"))},internal.stringToBoolean=function(a){return"undefined"!=typeof a?Boolean(a):void 0},internal.timeOutFunction=function(a){a.css("visibility","hidden")},internal.timeOutProgressBar=function(a){a.fadeOut()},internal.supportsVideo=function(){return!!document.createElement("video").canPlayType},external.getVersion=function(){},internal.init(),external}(jQuery);

(function (exports, $) {
    'use strict';

    /********************************************************************************
     *																				*
     *							Campaign specific javascript						*
     *																				*
     ********************************************************************************/

    // Set up event listeners
    hm.campaign.addEventListener(hm.campaign.READY, onFrameworkReady);

    // Set up "global" vars
    var globalShare;
    /**
     *	Callback for when the framework is ready
     */
    function onFrameworkReady() {
        // Inject share API
        hm.campaign.utils.injectJS('//s1-cdn.hm.com/hm.com/hm-share/1.10.0/hm-share.min.js');
        // hm.campaign.utils.injectJS(hm.campaign_data.base_url + 'resources/js/hm.videoplayer-3.5.2.js');

        // add listener for when the articles has been loaded
        hm.campaign.addEventListener(hm.campaign.ARTICLES_RETRIEVED, articlesLoaded);
        hm.campaign.addEventListener(hm.campaign.ARTICLES_PROGRESS, articlesProgress);

        // load the articles
        hm.campaign.api.article.loadArticles();

        // track page
        hm.campaign.api.statistics.trackPage('inspiration');

        window.onPlayerReady = function () {}; // This function needs to be defined for videoplayer (version 3.2.1)

        // Load more stuff
        // hm.campaign.utils.injectJS(hm.campaign_data.base_url + '/resources/js/extra.js');

        // hm.campaign.utils.injectCSS(hm.campaign_data.base_url + '/resources/css/extra.css');

        window.onPlayerReady = function () {}; // This function needs to be defined for videoplayer (version 3.2.1)
        hm.videoplayer.parseDOM();
    }

    /**
     *	Callback for when requested articles has been loaded
     */
    function articlesLoaded() {
        hm.campaign.utils.injectJS(hm.campaign_data.base_url + 'resources/js/main.js');
        // Init widget functionality
        hm.campaign.widget.replace($('#campaign'));

        // show the page when framework is loaded and first image is loaded. If the iamge already is loaded or if it takes to long we load the campaign anyways.
        var firstImage = $('section#start img').first()[0];
        if(firstImage.complete){
            initCampaign();
        } else {
            firstImage.onload = function() {
              initCampaign();
            };
        }
        setTimeout(function() {
          initCampaign();
        }, 5000);

        // $('<img src="' + hm.campaign.baseUrl + 'poster.jpg">')
        //     .on('load', hm.campaign.api.statistics.interactionReady);
    }

    function openStoreLocator() {
        var campaignConceptId = '1035_David_Beckham_Bodywear';
        var departmentId = '72a838d6-cdfc-48a8-b7c8-46d294ea7fa6';
        var departmentLabel = 'Custom Department Label';

        hm.campaign.api.storelocator.show(campaignConceptId, departmentId, departmentLabel);
    }

    function articlesProgress() {
        // If we want to react to progress of loaded articles
    }

    /**
     *	Callback for when page HASH link has been updated
     */
    function onHashChange(page) {
        // tell framework to load selected page and trigger callback onPageLoaded when page has been loaded successfully
        hm.campaign.loadPage(page, onPageLoaded);
    }

    /**
     *	Callback for when a page has finished loading
     */
    function onPageLoaded(pageContent, pageId) {
        hm.videoplayer.parseDOM();
        // Track page
        hm.campaign.api.statistics.trackPage(pageId);
    }

    function initCampaign() {

      hm.campaign.hideNativeLoader();
      $('#campaign').addClass('ready');
      $(window).trigger('resize');
    }

})(this, jQuery);

hm.campaign.countryInfo = {"en_eur":{"country":"EU","imageRestriction":0,"language":"en","locale":"en_EUR","localizationUrlPrefix":"/en_eur","isTransactional":1,"shopNowLabel":"Shop Now","articleCountry":"hm-europe","currency":"[price] €","decimals":"2","delimeter":","},"ae":{"country":"AE","imageRestriction":1,"language":"ar","locale":"ar_AE","localizationUrlPrefix":"/ae","isTransactional":0},"ae_ar":{"country":"AE","imageRestriction":1,"language":"ar","locale":"ar_AE","localizationUrlPrefix":"/ae","isTransactional":0},"at":{"country":"AT","imageRestriction":0,"language":"de","locale":"de_AT","localizationUrlPrefix":"/at","isTransactional":1},"at_de":{"country":"AT","imageRestriction":0,"language":"de","locale":"de_AT","localizationUrlPrefix":"/at","isTransactional":1},"au":{"country":"AU","imageRestriction":0,"language":"en","locale":"en_AU","localizationUrlPrefix":"/au","isTransactional":0},"au_en":{"country":"AU","imageRestriction":0,"language":"en","locale":"en_AU","localizationUrlPrefix":"/au","isTransactional":0},"fr_be":{"country":"BE","imageRestriction":0,"language":"fr","locale":"fr_BE","localizationUrlPrefix":"/fr_be","isTransactional":1,"shopNowLabel":"Shopping","articleCountry":"hm-belgium","currency":"€ [price]","decimals":"2","delimeter":","},"nl_be":{"country":"BE","imageRestriction":0,"language":"nl","locale":"nl_BE","localizationUrlPrefix":"/nl_be","isTransactional":1,"shopNowLabel":"Nu winkelen","articleCountry":"hm-belgium","currency":"€ [price]","decimals":"2","articleLanguage":"nl","delimeter":","},"bg_bg":{"country":"BG","imageRestriction":0,"language":"bg","locale":"bg_BG","localizationUrlPrefix":"/bg_bg","isTransactional":1,"shopNowLabel":"Пазарувайте сега","articleCountry":"hm-bulgaria","currency":"[price] лв","decimals":"2","delimeter":","},"bh":{"country":"BH","imageRestriction":1,"language":"ar","locale":"ar_BH","localizationUrlPrefix":"/bh","isTransactional":0},"bh_ar":{"country":"BH","imageRestriction":1,"language":"ar","locale":"ar_BH","localizationUrlPrefix":"/bh","isTransactional":0},"en_ca":{"country":"CA","imageRestriction":0,"language":"en","locale":"en_CA","localizationUrlPrefix":"/en_ca","isTransactional":1,"shopNowLabel":"Shop Now","articleCountry":"hm-canada","currency":"$[price]","articleLanguage":"en","decimals":"2"},"fr_ca":{"country":"CA","imageRestriction":0,"language":"fr","locale":"fr_CA","localizationUrlPrefix":"/fr_ca","isTransactional":1,"shopNowLabel":"Commencez à magasiner","articleCountry":"hm-canada","currency":"[price] $","decimals":"2","delimeter":","},"cy":{"country":"CY","imageRestriction":0,"language":"en","locale":"en_CY","localizationUrlPrefix":"/cy","isTransactional":0},"cy_en":{"country":"CY","imageRestriction":0,"language":"en","locale":"en_CY","localizationUrlPrefix":"/cy","isTransactional":0},"de_ch":{"country":"CH","imageRestriction":0,"language":"de","locale":"de_CH","localizationUrlPrefix":"/de_ch","isTransactional":1,"shopNowLabel":"Jetzt kaufen","articleCountry":"hm-switzerland","currency":"CHF [price]","decimals":"2"},"fr_ch":{"country":"CH","imageRestriction":0,"language":"fr","locale":"fr_CH","localizationUrlPrefix":"/fr_ch","isTransactional":1,"shopNowLabel":"Shopping","articleCountry":"hm-switzerland","currency":"CHF [price]","decimals":"2","articleLanguage":"fr"},"it_ch":{"country":"CH","imageRestriction":0,"language":"it","locale":"it_CH","localizationUrlPrefix":"/it_ch","isTransactional":1,"shopNowLabel":"Acquista","articleCountry":"hm-switzerland","currency":"CHF [price]","decimals":"2","articleLanguage":"it"},"cl":{"country":"CL","imageRestriction":0,"language":"es","locale":"es_CL","localizationUrlPrefix":"/cl","isTransactional":0},"cl_es":{"country":"CL","imageRestriction":0,"language":"es","locale":"es_CL","localizationUrlPrefix":"/cl","isTransactional":0},"co":{"country":"CO","imageRestriction":0,"language":"es","locale":"es_CO","localizationUrlPrefix":"/co","isTransactional":0},"co_es":{"country":"CO","imageRestriction":0,"language":"es","locale":"es_CO","localizationUrlPrefix":"/co","isTransactional":0},"en_gb":{"country":"GB","imageRestriction":0,"language":"en","locale":"en_GB","localizationUrlPrefix":"/en_gb","isTransactional":1,"shopNowLabel":"Shop Now","articleCountry":"hm-greatbritain","currency":"£[price]","decimals":"2"},"en_cn":{"country":"CN","imageRestriction":0,"language":"en","locale":"en_CN","localizationUrlPrefix":"/en_cn","isTransactional":1,"shopNowLabel":"Shop Now","articleCountry":"hm-china","currency":"¥[price]","decimals":"2","articleLanguage":"en"},"zh_cn":{"country":"CN","imageRestriction":0,"language":"zh","locale":"zh_CN","localizationUrlPrefix":"/zh_cn","isTransactional":1,"shopNowLabel":"即刻选购","articleCountry":"hm-china","currency":"¥[price]","decimals":"2"},"cs_cz":{"country":"CZ","imageRestriction":0,"language":"cs","locale":"cs_CZ","localizationUrlPrefix":"/cs_cz","isTransactional":1,"shopNowLabel":"Nakupovat nyní","articleCountry":"hm-czech","currency":"[price] Kč","decimals":"0"},"de":{"country":"DE","imageRestriction":0,"language":"de","locale":"de_DE","localizationUrlPrefix":"/de","isTransactional":1},"de_de":{"country":"DE","imageRestriction":0,"language":"de","locale":"de_DE","localizationUrlPrefix":"/de","isTransactional":1},"dk":{"country":"DK","imageRestriction":0,"language":"da","locale":"da_DK","localizationUrlPrefix":"/dk","isTransactional":1},"dk_da":{"country":"DK","imageRestriction":0,"language":"da","locale":"da_DK","localizationUrlPrefix":"/dk","isTransactional":1},"da_dk":{"country":"DK","imageRestriction":0,"language":"da","locale":"da_DK","localizationUrlPrefix":"/da_dk","isTransactional":1,"shopNowLabel":"Shop Nu","articleCountry":"hm-denmark","currency":"[price] kr","decimals":"2","delimeter":"."},"eg":{"country":"EG","imageRestriction":1,"language":"ar","locale":"ar_EG","localizationUrlPrefix":"/eg","isTransactional":0},"eg_ar":{"country":"EG","imageRestriction":1,"language":"ar","locale":"ar_EG","localizationUrlPrefix":"/eg","isTransactional":0},"es_es":{"country":"ES","imageRestriction":0,"language":"es","locale":"es_ES","localizationUrlPrefix":"/es_es","isTransactional":1,"shopNowLabel":"Comprar","articleCountry":"hm-spain","currency":"[price] €","decimals":"2","delimeter":","},"fi":{"country":"FI","imageRestriction":0,"language":"fi","locale":"fi_FI","localizationUrlPrefix":"/fi","isTransactional":1},"fi_fi":{"country":"FI","imageRestriction":0,"language":"fi","locale":"fi_FI","localizationUrlPrefix":"/fi_fi","isTransactional":1,"shopNowLabel":"OSTA NYT","articleCountry":"hm-finland","currency":"[price] €","decimals":"2","delimeter":","},"fi_sv":{"country":"FI","imageRestriction":0,"language":"sv","locale":"sv_FI","localizationUrlPrefix":"/fi/sv","isTransactional":1},"fr_fr":{"country":"FR","imageRestriction":0,"language":"fr","locale":"fr_FR","localizationUrlPrefix":"/fr_fr","isTransactional":1,"shopNowLabel":"Shopping","articleCountry":"hm-france","currency":"[price] €","delimeter":",","decimals":"2"},"hk":{"country":"HK","imageRestriction":0,"language":"zh","locale":"zh_HK","localizationUrlPrefix":"/hk","isTransactional":0,"shopNowLabel":"快速查看"},"hk_zh":{"country":"HK","imageRestriction":0,"language":"zh","locale":"zh_HK","localizationUrlPrefix":"/hk","isTransactional":0,"shopNowLabel":"快速查看"},"hk_en":{"country":"HK","imageRestriction":0,"language":"en","locale":"en_HK","localizationUrlPrefix":"/hk/en","isTransactional":0},"hu_hu":{"country":"HU","imageRestriction":0,"language":"hu","locale":"hu_HU","localizationUrlPrefix":"/hu_hu","isTransactional":1,"shopNowLabel":"Vásárlás most","articleCountry":"hm-hungary","currency":"[price] Ft","decimals":"0"},"id":{"country":"ID","imageRestriction":0,"language":"in","locale":"in_ID","localizationUrlPrefix":"/id","isTransactional":0},"id_in":{"country":"ID","imageRestriction":0,"language":"in","locale":"in_ID","localizationUrlPrefix":"/id","isTransactional":0},"en_ie":{"country":"IE","imageRestriction":0,"language":"en","locale":"en_IE","localizationUrlPrefix":"/en_ie","isTransactional":1,"shopNowLabel":"Shop Now","articleCountry":"hm-ireland","currency":"€[price]","decimals":"2"},"il":{"country":"IL","imageRestriction":0,"language":"iw","locale":"iw_IL","localizationUrlPrefix":"/il","isTransactional":0},"il_iw":{"country":"IL","imageRestriction":0,"language":"iw","locale":"iw_IL","localizationUrlPrefix":"/il","isTransactional":0},"in":{"country":"in","imageRestriction":0,"language":"en","locale":"en_IN","localizationUrlPrefix":"/in","isTransactional":0},"in_en":{"country":"in","imageRestriction":0,"language":"en","locale":"en_IN","localizationUrlPrefix":"/in","isTransactional":0},"it_it":{"country":"IT","imageRestriction":0,"language":"it","locale":"it_IT","localizationUrlPrefix":"/it_it","isTransactional":1,"shopNowLabel":"Acquista","articleCountry":"hm-italy","currency":"€[price]","decimals":"2","delimeter":","},"jo":{"country":"JO","imageRestriction":1,"language":"ar","locale":"ar_JO","localizationUrlPrefix":"/jo","isTransactional":0},"jo_ar":{"country":"JO","imageRestriction":1,"language":"ar","locale":"ar_JO","localizationUrlPrefix":"/jo","isTransactional":0},"ja_jp":{"country":"JP","imageRestriction":0,"language":"ja","locale":"ja_JP","localizationUrlPrefix":"/ja_jp","isTransactional":1,"shopNowLabel":"今すぐ購入する","articleCountry":"hm-japan","currency":"￥[price]","decimals":"0"},"ko_kr":{"country":"KR","imageRestriction":0,"language":"ko","locale":"ko_KR","localizationUrlPrefix":"/ko_kr","isTransactional":1,"shopNowLabel":"바로 쇼핑","articleCountry":"hm-korea","currency":"￦ [price]","decimals":"0"},"kw":{"country":"KW","imageRestriction":1,"language":"ar","locale":"ar_KW","localizationUrlPrefix":"/kw","isTransactional":0},"kw_ar":{"country":"KW","imageRestriction":1,"language":"ar","locale":"ar_KW","localizationUrlPrefix":"/kw","isTransactional":0},"lb":{"country":"LB","imageRestriction":0,"language":"ar","locale":"ar_LB","localizationUrlPrefix":"/lb","isTransactional":0},"lb_ar":{"country":"LB","imageRestriction":0,"language":"ar","locale":"ar_LB","localizationUrlPrefix":"/lb","isTransactional":0},"ma":{"country":"MA","imageRestriction":0,"language":"ar","locale":"ar_MA","localizationUrlPrefix":"/ma","isTransactional":0},"ma_ar":{"country":"MA","imageRestriction":1,"language":"ar","locale":"ar_MA","localizationUrlPrefix":"/ma","isTransactional":0},"mo":{"country":"MO","imageRestriction":0,"language":"zh","locale":"zh_MO","localizationUrlPrefix":"/mo","isTransactional":0},"mo_zh":{"country":"MO","imageRestriction":0,"language":"zh","locale":"zh_MO","localizationUrlPrefix":"/mo","isTransactional":0},"mo_en":{"country":"MO","imageRestriction":0,"language":"en","locale":"en_MO","localizationUrlPrefix":"/mo/en","isTransactional":0},"mx":{"country":"MX","imageRestriction":0,"language":"es","locale":"es_MX","localizationUrlPrefix":"/mx","isTransactional":0},"mx_es":{"country":"MX","imageRestriction":0,"language":"es","locale":"es_MX","localizationUrlPrefix":"/mx","isTransactional":0},"my":{"country":"MY","imageRestriction":0,"language":"ms","locale":"ms_MY","localizationUrlPrefix":"/my","isTransactional":0},"my_ms":{"country":"MY","imageRestriction":0,"language":"ms","locale":"ms_MY","localizationUrlPrefix":"/my","isTransactional":0},"nl_nl":{"country":"NL","imageRestriction":0,"language":"nl","locale":"nl_NL","localizationUrlPrefix":"/nl_nl","isTransactional":1,"shopNowLabel":"Shop nu","articleCountry":"hm-netherlands","currency":"€ [price]","decimals":"2","delimeter":","},"no":{"country":"NO","imageRestriction":0,"language":"no","locale":"no_NO","localizationUrlPrefix":"/no","isTransactional":1},"no_no":{"country":"NO","imageRestriction":0,"language":"no","locale":"no_NO","localizationUrlPrefix":"/no","isTransactional":1},"nz":{"country":"NZ","imageRestriction":0,"language":"en","locale":"en_NZ","localizationUrlPrefix":"/nz","isTransactional":0},"nz_en":{"country":"NZ","imageRestriction":0,"language":"en","locale":"en_NZ","localizationUrlPrefix":"/nz","isTransactional":0},"om":{"country":"OM","imageRestriction":1,"language":"ar","locale":"ar_OM","localizationUrlPrefix":"/om","isTransactional":0},"om_ar":{"country":"OM","imageRestriction":1,"language":"ar","locale":"ar_OM","localizationUrlPrefix":"/om","isTransactional":0},"pe":{"country":"PE","imageRestriction":0,"language":"es","locale":"es_PE","localizationUrlPrefix":"/pe","isTransactional":0},"pe_es":{"country":"PE","imageRestriction":0,"language":"es","locale":"es_PE","localizationUrlPrefix":"/pe","isTransactional":0},"ph":{"country":"PH","imageRestriction":0,"language":"en","locale":"en_PH","localizationUrlPrefix":"/ph","isTransactional":0},"ph_en":{"country":"PH","imageRestriction":0,"language":"en","locale":"en_PH","localizationUrlPrefix":"/ph","isTransactional":0},"pl_pl":{"country":"PL","imageRestriction":0,"language":"pl","locale":"pl_PL","localizationUrlPrefix":"/pl_pl","isTransactional":1,"shopNowLabel":"Kup teraz","articleCountry":"hm-poland","currency":"[price] PLN","decimals":"2","delimeter":","},"pt_pt":{"country":"PT","imageRestriction":0,"language":"pt","locale":"pt_PT","localizationUrlPrefix":"/pt_pt","isTransactional":1,"shopNowLabel":"Comprar agora","articleCountry":"hm-portugal","currency":"[price] €","decimals":"2","delimeter":","},"qa":{"country":"QA","imageRestriction":1,"language":"ar","locale":"ar_QA","localizationUrlPrefix":"/qa","isTransactional":0},"qa_ar":{"country":"QA","imageRestriction":1,"language":"ar","locale":"ar_QA","localizationUrlPrefix":"/qa","isTransactional":0},"ro_ro":{"country":"RO","imageRestriction":0,"language":"ro","locale":"ro_RO","localizationUrlPrefix":"/ro_ro","isTransactional":1,"shopNowLabel":"Cumpăraţi acum","articleCountry":"hm-romania","currency":"[price] LEI","decimals":"2","delimeter":","},"rs":{"country":"RS","imageRestriction":0,"language":"sr","locale":"sr_RS","localizationUrlPrefix":"/rs","isTransactional":0},"rs_sr":{"country":"RS","imageRestriction":0,"language":"sr","locale":"sr_RS","localizationUrlPrefix":"/rs","isTransactional":0},"kz":{"country":"KZ","imageRestriction":0,"language":"ru","locale":"ru_KZ","localizationUrlPrefix":"/kz","isTransactional":0},"kz_ru":{"country":"KZ","imageRestriction":0,"language":"ru","locale":"ru_KZ","localizationUrlPrefix":"/kz","isTransactional":0},"ru_ru":{"country":"RU","imageRestriction":0,"language":"ru","locale":"ru_RU","localizationUrlPrefix":"/ru_ru","isTransactional":0,"shopNowLabel":"Купить сейчас","articleCountry":"hm-russia","currency":"[price] Руб","decimals":"0"},"sa":{"country":"SA","imageRestriction":1,"language":"ar","locale":"ar_SA","localizationUrlPrefix":"/sa","isTransactional":0},"sa_ar":{"country":"SA","imageRestriction":1,"language":"ar","locale":"ar_SA","localizationUrlPrefix":"/sa","isTransactional":0},"se":{"country":"SE","imageRestriction":0,"language":"sv","locale":"sv_SE","localizationUrlPrefix":"/se","isTransactional":1},"se_sv":{"country":"SE","imageRestriction":0,"language":"sv","locale":"sv_SE","localizationUrlPrefix":"/se","isTransactional":1},"sg":{"country":"SG","imageRestriction":0,"language":"en","locale":"en_SG","localizationUrlPrefix":"/sg","isTransactional":0},"sg_en":{"country":"SG","imageRestriction":0,"language":"en","locale":"en_SG","localizationUrlPrefix":"/sg","isTransactional":0},"sk_sk":{"country":"SK","imageRestriction":0,"language":"sk","locale":"sk_SK","localizationUrlPrefix":"/sk_sk","isTransactional":1,"shopNowLabel":"Nakupovať ihneď","articleCountry":"hm-slovakia","currency":"[price] €","decimals":"2","delimeter":","},"sv_fi":{"country":"FI","imageRestriction":0,"language":"fi","locale":"sv_FI","localizationUrlPrefix":"/sv_fi","isTransactional":1,"shopNowLabel":"SHOPPA NU","articleCountry":"hm-finland","currency":"[price] €","decimals":"2","delimeter":","},"th":{"country":"TH","imageRestriction":0,"language":"th","locale":"th_TH","localizationUrlPrefix":"/th","isTransactional":0},"th_th":{"country":"TH","imageRestriction":0,"language":"th","locale":"th_TH","localizationUrlPrefix":"/th/th","isTransactional":0},"tr":{"country":"TR","imageRestriction":0,"language":"tr","locale":"tr_TR","localizationUrlPrefix":"/tr","isTransactional":0},"tr_tr":{"country":"TR","imageRestriction":0,"language":"tr","locale":"tr_TR","localizationUrlPrefix":"/tr_tr","isTransactional":1,"shopNowLabel":"ŞİMDİ SATIN AL","articleCountry":"hm-turkey","currency":"[price] TL","decimals":"2","delimeter":","},"tw":{"country":"TW","imageRestriction":0,"language":"zh","locale":"zh_TW","localizationUrlPrefix":"/tw","isTransactional":0},"tw_zh":{"country":"TW","imageRestriction":0,"language":"zh","locale":"zh_TW","localizationUrlPrefix":"/tw","isTransactional":0},"tw_en":{"country":"TW","imageRestriction":0,"language":"en","locale":"en_TW","localizationUrlPrefix":"/tw/en","isTransactional":0},"us":{"country":"US","imageRestriction":0,"language":"en","locale":"en_US","localizationUrlPrefix":"/us","isTransactional":1},"us_en":{"country":"US","imageRestriction":0,"language":"en","locale":"en_US","localizationUrlPrefix":"/us","isTransactional":1},"za":{"country":"ZA","imageRestriction":0,"language":"en","locale":"en_ZA","localizationUrlPrefix":"/za","isTransactional":0},"za_en":{"country":"ZA","imageRestriction":0,"language":"en","locale":"en_ZA","localizationUrlPrefix":"/za","isTransactional":0}};

//Campaign configuration
hm.campaign_data = $.extend(hm.campaign_data, {"campaignId":"8NB_Spring-Fashion","showAvailability": true,"showDesignerInfo": false,"showSizeSpan": false,"articles": {"article-1":"0484639006","article-2":"0466815001","article-3":"0514992001","article-4":"0473041001","article-5":"0479633001","article-6":"0493325001","article-7":"0488256001","article-8":"0479631001","article-9":"0506260001","article-10":"0487965001","article-11":"0488257001","article-12":"0491927003","article-13":"0479632003","article-14":"0490092004","article-15":"0506817001","article-16":"0501340001","article-17":"0479638001","article-18":"0506816001","article-19":"0511944001","article-20":"0490092001","article-21":"0400837002","article-22":"0479635003","article-23":"0487965002","article-24":"0479206005","article-25":"0478407002","article-26":"0466801006","article-27":"0479640001","article-28":"0485274003","article-29":"0503199002","article-30":"0487796001","article-31":"0479634002","article-32":"0498870002","article-33":"0434773008","article-34":"0499807002"  },"startDate":"20170401"});

//Campaign configuration
hm.campaign_config = {"ignore": {"js": ["js/extra.js"],"js": ["js/main.js"]    },"jsFiles": ["js/hm.videoplayer-3.5.2.js","js/first.js"    ],"modules": ["loader","price","quicklook","article"    ],"minify": false};
// Load initial content and init campaign
hm.campaign.init();

